<!DOCTYPE html>
<!--[if lt IE 7]><html class="lt-ie9 lt-ie8 lt-ie7" lang="en" dir="ltr"><![endif]-->
<!--[if IE 7]><html class="lt-ie9 lt-ie8" lang="en" dir="ltr"><![endif]-->
<!--[if IE 8]><html class="lt-ie9" lang="en" dir="ltr"><![endif]-->
<!--[if gt IE 8]><!-->
<html lang="en" dir="ltr"
  prefix="fb: http://ogp.me/ns/fb# content: http://purl.org/rss/1.0/modules/content/ dc: http://purl.org/dc/terms/ foaf: http://xmlns.com/foaf/0.1/ og: http://ogp.me/ns# rdfs: http://www.w3.org/2000/01/rdf-schema# sioc: http://rdfs.org/sioc/ns# sioct: http://rdfs.org/sioc/types# skos: http://www.w3.org/2004/02/skos/core# xsd: http://www.w3.org/2001/XMLSchema#">
<!--<![endif]-->

<!-- Mirrored from web-engineering.info/node/74 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 21 Jul 2023 10:44:34 GMT -->
<!-- Added by HTTrack -->
<meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->

<head>
  <meta charset="utf-8" />
  <link rel="shortcut icon" href="../sites/default/files/machine-build-16x16_0.png" type="image/png" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="MobileOptimized" content="width" />
  <meta name="description"
    content="In this article, we show how to create and clear an IndexedDB database keeping all code in a single HTML file. Creating an IndexedDB database means first creating an empty database, and then adding records to its empty tables (or &quot;object stores&quot;). In Part 2, we will explain how to retrieve, update and delete IndexedDB records, such that we get the full collection of CRUD" />
  <meta name="HandheldFriendly" content="true" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <link rel="canonical" href="74.html" />
  <link rel="shortlink" href="74.html" />
  <title>CRUD Operations with IndexedDB - Part 1: Creating and Clearing a Database | web-engineering.info</title>
  <style type="text/css" media="all">
    @import url("../modules/system/system.base5056.css?ry1opl");
    @import url("../modules/system/system.menus5056.css?ry1opl");
    @import url("../modules/system/system.messages5056.css?ry1opl");
    @import url("../modules/system/system.theme5056.css?ry1opl");
  </style>
  <style type="text/css" media="all">
    @import url("../modules/comment/comment5056.css?ry1opl");
    @import url("../modules/field/theme/field5056.css?ry1opl");
    @import url("../modules/node/node5056.css?ry1opl");
    @import url("../modules/search/search5056.css?ry1opl");
    @import url("../modules/user/user5056.css?ry1opl");
    @import url("../modules/forum/forum5056.css?ry1opl");
    @import url("../sites/all/modules/views/css/views5056.css?ry1opl");
    @import url("../sites/all/modules/ckeditor/css/ckeditor5056.css?ry1opl");
  </style>
  <style type="text/css" media="all">
    @import url("../sites/all/modules/ctools/css/ctools5056.css?ry1opl");
    @import url("../sites/all/modules/easy_social/css/easy_social5056.css?ry1opl");
  </style>
  <style type="text/css" media="screen">
    @import url("../sites/all/themes/adaptivetheme/at_core/css/at.settings.style.headings5056.css?ry1opl");
    @import url("../sites/all/themes/adaptivetheme/at_core/css/at.settings.style.image5056.css?ry1opl");
    @import url("../sites/all/themes/adaptivetheme/at_core/css/at.layout5056.css?ry1opl");
  </style>
  <style type="text/css" media="all">
    @import url("../sites/all/themes/corolla/css/webeng.custom5056.css?ry1opl");
    @import url("../sites/all/themes/corolla/css/html-elements5056.css?ry1opl");
    @import url("../sites/all/themes/corolla/css/forms5056.css?ry1opl");
    @import url("../sites/all/themes/corolla/css/tables5056.css?ry1opl");
    @import url("../sites/all/themes/corolla/css/page5056.css?ry1opl");
    @import url("../sites/all/themes/corolla/css/articles5056.css?ry1opl");
    @import url("../sites/all/themes/corolla/css/comments5056.css?ry1opl");
    @import url("../sites/all/themes/corolla/css/fields5056.css?ry1opl");
    @import url("../sites/all/themes/corolla/css/blocks5056.css?ry1opl");
    @import url("../sites/all/themes/corolla/css/navigation5056.css?ry1opl");
    @import url("../sites/all/themes/corolla/css/corolla.settings.style5056.css?ry1opl");
    @import url("../sites/all/themes/corolla/color/colors5056.css?ry1opl");
  </style>
  <style type="text/css" media="print">
    @import url("../sites/all/themes/corolla/css/print5056.css?ry1opl");
  </style>
  <link type="text/css" rel="stylesheet"
    href="../sites/default/files/adaptivetheme/corolla_files/corolla.responsive.layout5056.css?ry1opl"
    media="only screen" />
  <style type="text/css" media="screen">
    @import url("../sites/default/files/adaptivetheme/corolla_files/corolla.fonts5056.css?ry1opl");
  </style>
  <link type="text/css" rel="stylesheet" href="../sites/all/themes/corolla/css/responsive.custom5056.css?ry1opl"
    media="only screen" />
  <link type="text/css" rel="stylesheet"
    href="../sites/all/themes/corolla/css/responsive.smartphone.portrait5056.css?ry1opl"
    media="only screen and (max-width:320px)" />
  <link type="text/css" rel="stylesheet"
    href="../sites/all/themes/corolla/css/responsive.smartphone.landscape5056.css?ry1opl"
    media="only screen and (min-width:321px) and (max-width:480px)" />
  <link type="text/css" rel="stylesheet"
    href="../sites/all/themes/corolla/css/responsive.tablet.portrait5056.css?ry1opl"
    media="only screen and (min-width:481px) and (max-width:768px)" />
  <link type="text/css" rel="stylesheet"
    href="../sites/all/themes/corolla/css/responsive.tablet.landscape5056.css?ry1opl"
    media="only screen and (min-width:769px) and (max-width:1024px)" />
  <link type="text/css" rel="stylesheet" href="../sites/all/themes/corolla/css/responsive.desktop5056.css?ry1opl"
    media="only screen and (min-width:1025px)" />

  <!--[if lt IE 9]>
<style type="text/css" media="screen">
@import url("https://web-engineering.info/sites/default/files/adaptivetheme/corolla_files/corolla.lt-ie9.layout.css?ry1opl");
</style>
<![endif]-->

  <!--[if lte IE 9]>
<style type="text/css" media="screen">
@import url("https://web-engineering.info/sites/all/themes/corolla/css/ie-lte-9.css?ry1opl");
</style>
<![endif]-->
  <script type="text/javascript" src="../misc/jquery1cc4.js?v=1.4.4"></script>
  <script type="text/javascript" src="../misc/jquery-extend-3.4.01cc4.js?v=1.4.4"></script>
  <script type="text/javascript" src="../misc/jquery.once7839.js?v=1.2"></script>
  <script type="text/javascript" src="../misc/drupal5056.js?ry1opl"></script>
  <script type="text/javascript">
<!--//-->
  < ![CDATA[//><!--
      (function (d, s, id) {
        var js, fjs = d.getElementsByTagName(s)[0];
        if (d.getElementById(id)) { return; }
        js = d.createElement(s); js.id = id;
        js.src = "../../connect.facebook.net/en_US/all.js#xfbml=1&appId=";
        fjs.parentNode.insertBefore(js, fjs);
      }(document, 'script', 'facebook-jssdk'));
//--><!]]>
  </script>
  <script type="text/javascript" src="../sites/all/modules/google_analytics/googleanalytics5056.js?ry1opl"></script>
  <script type="text/javascript" src="../../platform.linkedin.com/in.js"></script>
  <script type="text/javascript" src="../../platform.twitter.com/widgets.js"></script>
  <script type="text/javascript" src="../../apis.google.com/js/plusone.js"></script>
  <script type="text/javascript">
<!--//-->
  < ![CDATA[//><!--
      (function (i, s, o, g, r, a, m) { i["GoogleAnalyticsObject"] = r; i[r] = i[r] || function () { (i[r].q = i[r].q || []).push(arguments) }, i[r].l = 1 * new Date(); a = s.createElement(o), m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m) })(window, document, "script", "../../www.google-analytics.com/analytics.js", "ga"); ga("create", "UA-48105674-1", { "cookieDomain": "auto" }); ga("set", "anonymizeIp", true); ga("send", "pageview");
//--><!]]>
  </script>
  <script type="text/javascript" src="../sites/all/modules/disqus/disqus5056.js?ry1opl"></script>
  <script type="text/javascript">
<!--//-->
  < ![CDATA[//><!--
          jQuery.extend(Drupal.settings, { "basePath": "\/", "pathPrefix": "", "ajaxPageState": { "theme": "corolla", "theme_token": "PcmVhIdCpYwFjXQ-hbwe1PGhLo54qxCflpGx2rE3pls", "js": { "misc\/jquery.js": 1, "misc\/jquery-extend-3.4.0.js": 1, "misc\/jquery.once.js": 1, "misc\/drupal.js": 1, "0": 1, "sites\/all\/modules\/google_analytics\/googleanalytics.js": 1, "\/\/platform.linkedin.com\/in.js": 1, "\/\/platform.twitter.com\/widgets.js": 1, "\/\/apis.google.com\/js\/plusone.js": 1, "1": 1, "sites\/all\/modules\/disqus\/disqus.js": 1 }, "css": { "modules\/system\/system.base.css": 1, "modules\/system\/system.menus.css": 1, "modules\/system\/system.messages.css": 1, "modules\/system\/system.theme.css": 1, "modules\/comment\/comment.css": 1, "modules\/field\/theme\/field.css": 1, "modules\/node\/node.css": 1, "modules\/search\/search.css": 1, "modules\/user\/user.css": 1, "modules\/forum\/forum.css": 1, "sites\/all\/modules\/views\/css\/views.css": 1, "sites\/all\/modules\/ckeditor\/css\/ckeditor.css": 1, "sites\/all\/modules\/ctools\/css\/ctools.css": 1, "sites\/all\/modules\/easy_social\/css\/easy_social.css": 1, "sites\/all\/themes\/adaptivetheme\/at_core\/css\/at.settings.style.headings.css": 1, "sites\/all\/themes\/adaptivetheme\/at_core\/css\/at.settings.style.image.css": 1, "sites\/all\/themes\/adaptivetheme\/at_core\/css\/at.layout.css": 1, "sites\/all\/themes\/corolla\/css\/webeng.custom.css": 1, "sites\/all\/themes\/corolla\/css\/html-elements.css": 1, "sites\/all\/themes\/corolla\/css\/forms.css": 1, "sites\/all\/themes\/corolla\/css\/tables.css": 1, "sites\/all\/themes\/corolla\/css\/page.css": 1, "sites\/all\/themes\/corolla\/css\/articles.css": 1, "sites\/all\/themes\/corolla\/css\/comments.css": 1, "sites\/all\/themes\/corolla\/css\/fields.css": 1, "sites\/all\/themes\/corolla\/css\/blocks.css": 1, "sites\/all\/themes\/corolla\/css\/navigation.css": 1, "sites\/all\/themes\/corolla\/css\/fonts.css": 1, "sites\/all\/themes\/corolla\/css\/corolla.settings.style.css": 1, "sites\/all\/themes\/corolla\/color\/colors.css": 1, "sites\/all\/themes\/corolla\/css\/print.css": 1, "public:\/\/adaptivetheme\/corolla_files\/corolla.responsive.layout.css": 1, "public:\/\/adaptivetheme\/corolla_files\/corolla.fonts.css": 1, "sites\/all\/themes\/corolla\/css\/responsive.custom.css": 1, "sites\/all\/themes\/corolla\/css\/responsive.smartphone.portrait.css": 1, "sites\/all\/themes\/corolla\/css\/responsive.smartphone.landscape.css": 1, "sites\/all\/themes\/corolla\/css\/responsive.tablet.portrait.css": 1, "sites\/all\/themes\/corolla\/css\/responsive.tablet.landscape.css": 1, "sites\/all\/themes\/corolla\/css\/responsive.desktop.css": 1, "public:\/\/adaptivetheme\/corolla_files\/corolla.lt-ie9.layout.css": 1, "sites\/all\/themes\/corolla\/css\/ie-lte-9.css": 1 } }, "googleanalytics": { "trackOutbound": 1, "trackMailto": 1, "trackDownload": 1, "trackDownloadExtensions": "7z|aac|arc|arj|asf|asx|avi|bin|csv|doc(x|m)?|dot(x|m)?|exe|flv|gif|gz|gzip|hqx|jar|jpe?g|js|mp(2|3|4|e?g)|mov(ie)?|msi|msp|pdf|phps|png|ppt(x|m)?|pot(x|m)?|pps(x|m)?|ppam|sld(x|m)?|thmx|qtm?|ra(m|r)?|sea|sit|tar|tgz|torrent|txt|wav|wma|wmv|wpd|xls(x|m|b)?|xlt(x|m)|xlam|xml|z|zip" }, "urlIsAjaxTrusted": { "\/search\/node": true, "\/node\/74?destination=node\/74": true }, "disqus": { "domain": "web-engineering", "url": "https:\/\/web-engineering.info\/node\/74", "title": "CRUD Operations with IndexedDB - Part 1: Creating and Clearing a Database", "identifier": "node\/74" }, "adaptivetheme": { "corolla": { "layout_settings": { "bigscreen": "three-col-grail", "tablet_landscape": "three-col-grail", "tablet_portrait": "one-col-vert", "smalltouch_landscape": "one-col-vert", "smalltouch_portrait": "one-col-stack" }, "media_query_settings": { "bigscreen": "only screen and (min-width:1025px)", "tablet_landscape": "only screen and (min-width:769px) and (max-width:1024px)", "tablet_portrait": "only screen and (min-width:481px) and (max-width:768px)", "smalltouch_landscape": "only screen and (min-width:321px) and (max-width:480px)", "smalltouch_portrait": "only screen and (max-width:320px)" } } } });
//--><!]]>
  </script>
  <!--[if lt IE 9]>
<script src="https://web-engineering.info/sites/all/themes/adaptivetheme/at_core/scripts/html5.js?ry1opl"></script>
<![endif]-->
</head>

<body
  class="html not-front not-logged-in one-sidebar sidebar-first page-node page-node- page-node-74 node-type-blog atr-7.x-3.x atv-7.x-3.1 site-name-web-engineeringinfo section-node color-scheme-default corolla bs-n bb-n mb-dd rc-6 rct-6">
  <div id="skip-link" class="nocontent">
    <a href="#main-content" class="element-invisible element-focusable">Skip to main content</a>
  </div>
  <div id="page-wrapper">
    <div id="page"
      class="page snc-n snw-n sna-l sns-n ssc-n ssw-n ssa-l sss-n btc-n btw-b bta-l bts-n ntc-n ntw-b nta-l nts-n ctc-n ctw-b cta-l cts-n ptc-n ptw-b pta-l pts-n">


      <div id="header-wrapper">
        <div class="container clearfix">

          <header class="clearfix with-logo" role="banner">

            <div id="branding" class="branding-elements clearfix">

              <div id="logo">
                <a href="../index.html"><img class="site-logo" typeof="foaf:Image"
                    src="../sites/default/files/logo_1.png" alt="web-engineering.info" /></a>
              </div>

              <div class="h-group" id="name-and-slogan">

                <h1 id="site-name"><a href="../index.html" title="Home page">web-engineering.info</a></h1>

                <h2 id="site-slogan">High-quality resources for learning developers and makers</h2>

              </div>

            </div>


          </header>

        </div>
      </div>




      <div id="content-wrapper">
        <div class="container">

          <div id="columns">
            <div class="columns-inner clearfix">

              <div id="content-column">
                <div class="content-inner">


                  <section id="main-content" role="main">


                    <div class="content-margin">
                      <div class="content-style">


                        <div id="breadcrumb" class="clearfix">
                          <nav class="breadcrumb-wrapper clearfix" role="navigation" aria-labelledby="breadcrumb-label">
                            <h2 id="breadcrumb-label" class="element-invisible">You are here</h2>
                            <ol id="crumbs" class="clearfix">
                              <li class="crumb crumb-first"><span typeof="v:Breadcrumb"><a rel="v:url"
                                    property="v:title" href="../blog.html">Blogs</a></span></li>
                              <li class="crumb crumb-last"><span class="crumb-separator"> &#187; </span><span
                                  typeof="v:Breadcrumb"><a rel="v:url" property="v:title"
                                    href="../blog/2.html">gwagner&#039;s blog</a></span></li>
                            </ol>
                          </nav>
                        </div>

                        <header class="clearfix">
                          <h1 id="page-title">
                            CRUD Operations with IndexedDB - Part 1: Creating and Clearing a Database </h1>
                        </header>



                        <div id="content">
                          <div class="region region-content">
                            <div id="block-easy-social-easy-social-block-1"
                              class="block block-easy-social no-title odd first block-count-1 block-region-content block-easy-social-block-1">

                              <div class="easy_social_box clearfix horizontal easy_social_lang_en">
                                <div class="easy_social-widget easy_social-widget-twitter first"><a
                                    href="https://twitter.com/share" class="twitter-share-button"
                                    data-url="https://web-engineering.info/node/74" data-count="horizontal"
                                    data-lang="en" data-via="" data-related=":Check it out!"
                                    data-text="web-engineering.info">Tweet</a></div>
                                <div class="easy_social-widget easy_social-widget-facebook">
                                  <fb:like href="74.html" send="true" layout="button_count" width="88" show_faces="true"
                                    action="https://web-engineering.info/node/like" colorscheme="light" font="">
                                  </fb:like>
                                </div>
                                <div class="easy_social-widget easy_social-widget-googleplus">
                                  <div class="g-plusone" data-size="medium" data-annotation="bubble"
                                    data-href="https://web-engineering.info/node/74"></div>
                                </div>
                                <div class="easy_social-widget easy_social-widget-linkedin last">
                                  <script type="in/share" data-url="https://web-engineering.info/node/74"
                                    data-counter="right"></script>
                                </div>
                              </div> <!-- /.easy_social_box -->
                            </div>
                            <div id="block-system-main"
                              class="block block-system no-title even last block-count-2 block-region-content block-main">

                              <article id="node-74"
                                class="node node-blog node-promoted article odd node-with-picture node-full ia-n clearfix"
                                about="/node/74" typeof="sioc:Post sioct:BlogPost" role="article">
                                <div class="node-inner">


                                  <header class="node-header">


                                    <p class="submitted"><span property="dc:date dc:created"
                                        content="2021-07-12T17:02:47+02:00" datatype="xsd:dateTime"
                                        rel="sioc:has_creator">Submitted by <a href="../user/2.html"
                                          title="View user profile." class="username" xml:lang="" about="/user/2"
                                          typeof="sioc:UserAccount" property="foaf:name" datatype="">gwagner</a> on
                                        <time datetime="2021-07-12T17:02:47+0200">Mon, 07/12/2021 - 17:02</time></span>
                                    </p>

                                  </header>
                                  <span property="dc:title"
                                    content="CRUD Operations with IndexedDB - Part 1: Creating and Clearing a Database"
                                    class="rdf-meta element-hidden"></span><span property="sioc:num_replies" content="0"
                                    datatype="xsd:integer" class="rdf-meta element-hidden"></span>
                                  <div class="node-content">
                                    <div class="user-picture">
                                      <a href="../user/2.html" title="View user profile."><img typeof="foaf:Image"
                                          class="image-style-thumbnail"
                                          src="../sites/default/files/styles/thumbnail/public/pictures/picture-2-14442312552e30.jpg?itok=fLXXwl1V"
                                          alt="gwagner&#039;s picture" title="gwagner&#039;s picture" /></a>
                                    </div>
                                    <div
                                      class="field field-name-body field-type-text-with-summary field-label-hidden view-mode-full">
                                      <div class="field-items">
                                        <div class="field-item even" property="content:encoded">
                                          <p>In this article, we show how to create and clear an IndexedDB database
                                            keeping all code in a single HTML file. Creating an&nbsp;IndexedDB database
                                            means first creating an empty database, and then adding records to its empty
                                            tables (or "object stores"). In Part 2, we will explain how to retrieve,
                                            update and delete IndexedDB records, such that we get the full collection of
                                            CRUD operations: Create, Update, Retrieve and Delete.</p>

                                          <p>This is not an introduction to IndexedDB, but rather a guide how to use it
                                            for CRUD operations in a front-end app. We assume that the reader has
                                            already done an introductory tutorial such as <a
                                              href="https://developers.google.com/web/ilt/pwa/working-with-indexeddb">Working
                                              with IndexedDB</a>. Recall that an IndexedDB database is a set of object
                                            tables (or "object stores") where each table row, or record, has a standard
                                            ID (or "primary key") property defined with <code>keyPath</code> when
                                            creating the database.</p>

                                          <p>As recommended in <a
                                              href="https://developers.google.com/web/ilt/pwa/working-with-indexeddb">Working
                                              with IndexedDB</a>, we use the <a
                                              href="https://github.com/jakearchibald/idb">IndexedDB Promised</a>
                                            library, which wraps the <code>indexedDB</code> API with
                                            ES6-Promise/await-based methods for obtaining more readable and maintainable
                                            code in our IndexedDB access methods. Download it into your project folder
                                            such that it can be included with
                                            <code>&lt;script src="idb.js"&gt;&lt;/script&gt;</code> or load it from the
                                            CDN <a
                                              href="../../unpkg.com/idb%407.1.1/build/iife/index-min.js">https://unpkg.com/idb/build/iife/index-min.js</a>.
                                          </p>

                                          <p>We extend the "idb" namespace variable by adding three database management
                                            methods:</p>

                                          <dl>
                                            <dt>idb.<strong>createEmptyDB</strong>( <em>tableNames</em>)</dt>
                                            <dd>Checks if there is already a database with the given name, and, if not,
                                              creates one with an empty table (or "object store") for each of the table
                                              names provided.</dd>
                                            <dt>idb.<strong>addRecords</strong>( <em>tableName</em>, <em>records</em>)
                                            </dt>
                                            <dd>Adds a list of records to the given table.</dd>
                                            <dt>idb.<strong>clearDB</strong>()</dt>
                                            <dd>Clears the contents of all tables.</dd>
                                          </dl>

                                          <p>We start with looking at the code of the <code>createEmptyDB</code> method:
                                          </p>

                                          <pre>
&lt;!DOCTYPE html&gt;
&lt;html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"&gt;
&lt;head&gt;
 &lt;meta charset="UTF-8" /&gt;
 &lt;title&gt;CRUD Operations with IndexedDB - Part 1&lt;/title&gt;
 &lt;!-- Load the IndexedDB Promised library --&gt;
 &lt;script src="idb.js"&gt;&lt;/script&gt;
 &lt;script&gt;
  const dbName = "test";
  /*******************************************************************
   * Create an empty IndexedDB
   *******************************************************************/
  idb.<strong>createEmptyDB </strong>= async function (dbName, tableNames) {
   idb.db = await idb.openDB( dbName, 1, {
    upgrade(db) {
     for (const tn of tableNames) {
      if (!db.objectStoreNames.contains( tn)) {
       db.createObjectStore( tn, {keyPath:"id"});
      }
     }
    }
   });
  };
</pre>

                                          <p>We define a global variable <code>dbName</code> as the name of our
                                            IndexedDB database. The <code>idb.createEmptyDB</code> method takes a list
                                            of table names and tries to open the database (with version number 1). If
                                            this fails, that is, if the database does not yet exist, the function with
                                            the paramter <code>upgradeDb</code> will be called, taking care of creating
                                            an empty object store with a standard ID property "id" for each of the table
                                            names provided.</p>

                                          <p>For adding a list of records to a&nbsp;table (= object store) in one
                                            (transactional) step, we invoke the IndexedDB <code>add</code> method on the
                                            corresponding object store for each of them in parallel. Since each
                                            <code>add</code> invocation returns a promise object, we create a list of
                                            promise objects by mapping the <code>records</code> array to an array of
                                            <code>add</code> invocation expressions and use the <code>Promise.all</code>
                                            method for resolving this list&nbsp;of promises only when all of them have
                                            resolved:</p>

                                          <pre>
  idb.<strong>addRecords </strong>= async function (tableName, records) {
    // create a transaction involving only the table with the provided name
    const tx = idb.db.transaction( tableName, "readwrite");
    // create a list of add invocation expressions
    const addInvocationExpressions = records.map( r =&gt; tx.store.add( r));
    // invoke all of them in parallel and wait for their completion
    await Promise.all( addInvocationExpressions);
    // wait for the completion of the transaction tx
    await tx.done;
  };
</pre>

                                          <p>For clearing the entire database contents, we need to clear all object
                                            tables/stores by invoking the IndexedDB <code>clear</code> method on them.
                                            Again, we create a list of promises by mapping the
                                            <code>idbCx.objectStoreNames</code> collection to an array of
                                            <code>clear</code> invocation return values and use the
                                            <code>Promise.all</code> method for resolving this list only when all of
                                            them have resolved:</p>

                                          <pre>
  idb.<strong>clearDB </strong>= async function (dbName) {
    // only open DB and store a connection reference if not yet done
    idb.db ??= await idb.openDB( dbName);
    // create a transaction involving all tables of the database
    const tx = idb.db.transaction( idb.db.objectStoreNames, "readwrite");
    // create a list of clear invocation expressions
    const clearInvocationExpressions =
        Array.from( idb.db.objectStoreNames, osName =&gt; tx.objectStore( osName).clear());
    // invoke all of them in parallel and wait for their completion
    await Promise.all( clearInvocationExpressions);
    // wait for the completion of the transaction tx
    await tx.done;
  };</pre>

                                          <p>We also define a <code>createTestData</code> method:</p>

                                          <pre>
  async function <strong>createTestData</strong> () {
   await idb.<strong>addRecords</strong>( "books", [
     {id: "006251587X", title: "Weaving the Web", year: 2000, edition: 2},
     {id: "0465026567", title: "Gödel, Escher, Bach", year: 1999},
     {id: "0465030793", title: "I Am a Strange Loop", year: 2008}
   ]);
  }</pre>

                                          <p>Finally, we define an immediately invoked function expression (IIFE) for
                                            creating an empty database with name "test" having an empty table "books"
                                            and HTML buttons for invoking the&nbsp;<code>createTestData</code> method
                                            and for invoking the <code>clearDB</code> method:</p>

                                          <pre>
  (async function () {
   await idb.createEmptyDB("test",["books"]);
  })();
  &lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
 &lt;h1&gt;Working with IndexedDB&lt;/h1&gt;
 &lt;h2&gt;Creating and Clearing a Database&lt;/h2&gt;
  &lt;ul&gt;
    &lt;li&gt;&lt;button type="button" onclick="createTestData()"&gt;Generate&lt;/button&gt; test data&lt;/li&gt;
    &lt;li&gt;&lt;button type="button" onclick="idb.clearDB()"&gt;Clear&lt;/button&gt; database tables&lt;/li&gt;
  &lt;/ul&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>

                                          <p>Now it's time to try this out. Copy and paste all 5 HTML/JS code fragments
                                            from this article to a text editor and save it as an HTML file. Then, open
                                            it in a browser that allows accessing IndexedDB databases via
                                            <code>file</code> URLs (see the note below). Otherwise, open it via a
                                            (possibly local) web server. You can inspect the existence and contents of
                                            IndexedDB databases with the help your browser's developer tools (e.g. F12
                                            or with Shift-Ctrl-I). Try out the following steps:</p>

                                          <ol>
                                            <li>Check if an IndexedDB database with name "testDB" and an empty "books"
                                              table has been created.</li>
                                            <li>Press the button<button type="button">Generate</button>.</li>
                                            <li>Then check if the "books" table has been populated with 3 book records.
                                            </li>
                                            <li>Press the button<button type="button">Generate</button> again and
                                              observe a constraint validation error (in the console) due to an attempt
                                              to create another record with the same ID as an already stored one.</li>
                                            <li>Press the button<button type="button">Clear</button>.</li>
                                            <li>Then check if the "books" table has been cleared.</li>
                                            <li>Now you could create the test data again.</li>
                                          </ol>

                                          <blockquote style="font-size:smaller">
                                            <p><strong>Attention</strong></p>

                                            <p>While you can directly run IndexedDB JS code from a (local or remote)
                                              website (e.g., from a GitHub Pages website), you can only run it from your
                                              local file system after changing your browser's default configuration.</p>

                                            <p>For FireFox, you have to set the configuration property
                                              <code>security.fileuri.strict_origin_policy</code> to <i>false</i> by
                                              first entering <code>about:config</code> in the browser's web address bar
                                              and then entering this property name.</p>
                                          </blockquote>
                                        </div>
                                      </div>
                                    </div>
                                    <section
                                      class="field field-name-field-category field-type-taxonomy-term-reference field-label-above view-mode-full">
                                      <h2 class="field-label">Category:&nbsp;</h2>
                                      <ul class="field-items">
                                        <li class="field-item even"><a href="../taxonomy/term/55.html"
                                            typeof="skos:Concept" property="rdfs:label skos:prefLabel"
                                            datatype="">IndexedDB</a></li>
                                      </ul>
                                    </section>
                                    <div class="easy_social_box clearfix horizontal easy_social_lang_und">
                                      <div class="easy_social-widget easy_social-widget-twitter first"><a
                                          href="https://twitter.com/share" class="twitter-share-button"
                                          data-url="https://web-engineering.info/node/74" data-count="horizontal"
                                          data-lang="en" data-via="" data-related=":Check it out!"
                                          data-text="CRUD Operations with IndexedDB - Part 1: Creating and Clearing a Database">Tweet</a>
                                      </div>
                                      <div class="easy_social-widget easy_social-widget-facebook">
                                        <fb:like href="74.html" send="true" layout="button_count" width="88"
                                          show_faces="true" action="https://web-engineering.info/node/like"
                                          colorscheme="light" font=""></fb:like>
                                      </div>
                                      <div class="easy_social-widget easy_social-widget-googleplus">
                                        <div class="g-plusone" data-size="medium" data-annotation="bubble"
                                          data-href="74.html"></div>
                                      </div>
                                      <div class="easy_social-widget easy_social-widget-linkedin last">
                                        <script type="in/share" data-url="https://web-engineering.info/node/74"
                                          data-counter="right"></script>
                                      </div>
                                    </div> <!-- /.easy_social_box -->
                                    <div id="disqus_thread"><noscript>
                                        <p><a
                                            href="http://web-engineering.disqus.com/?url=https%3A%2F%2Fweb-engineering.info%2Fnode%2F74">View
                                            the discussion thread.</a></p>
                                      </noscript></div>
                                  </div>

                                  <nav class="clearfix">
                                    <ul class="links inline">
                                      <li class="blog_usernames_blog first last"><a href="../blog/2.html"
                                          title="Read gwagner&#039;s latest blog entries.">gwagner&#039;s blog</a></li>
                                    </ul>
                                  </nav>


                                </div>
                              </article>

                            </div>
                          </div>
                        </div>


                      </div>
                    </div>

                  </section>

                  <div class="region region-content-aside">
                    <div class="region-inner clearfix">
                      <div id="block-block-2"
                        class="block block-block no-title odd first last block-count-3 block-region-content-aside block-2">
                        <div class="block-inner clearfix">

                          <div class="block-content content">
                            <p style="text-align: center; margin-top: 10px;">©
                              2014-2020&nbsp;web-engineering.info&nbsp;<a
                                href="https://plus.google.com/104237216582874489152" rel="publisher"><img alt="G+"
                                  src="../../assets/images/gplus-16.png" style="width: 16px; height: 16px;" /></a> | <a
                                href="../../about/index.html">About Us</a> | <a href="../../privacy/index.html">Privacy
                                Policy</a> | Terms
                              &amp;
                              Conditions</p>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <div class="region region-sidebar-first sidebar">
                <div class="region-inner clearfix">
                  <nav id="block-system-main-menu"
                    class="block block-system block-menu odd first block-count-3 block-region-sidebar-first block-main-menu"
                    role="navigation">
                    <div class="block-inner clearfix">
                      <h2 class="block-title">Main menu</h2>

                      <div class="block-content content">
                        <ul class="menu clearfix">
                          <li class="first leaf menu-depth-1 menu-item-1476"><a href="https://sim4edu.com"
                              title="The Simulation for Education (Sim4edu) project website supports web-based simulation with open source technologies for science and education.">Web-Based
                              Discrete Event Simulation</a></li>
                          <li class="leaf menu-depth-1 menu-item-1218"><a href="../../WebAppBook/index.html"
                              title="Web Applications with JavaScript or Java">Textbook
                              Web Apps JS+Java</a></li>
                          <li class="leaf menu-depth-1 menu-item-1477"><a href="../../textbooknode80/index.html">Book
                              Information Management</a></li>
                          <li class="leaf menu-depth-1 menu-item-366"><a href="../../blog/index.html"
                              title="A blog about web engineering issues.">Web Engineering
                              Blog</a></li>
                          <li class="leaf menu-depth-1 menu-item-758"><a
                              href="../../SummariesCheatsheetsPosters/index.html">Summaries
                              &amp; Cheat
                              Sheets</a></li>
                          <li class="leaf menu-depth-1 menu-item-361"><a href="../../JsFrontendApp/index.html"
                              title="This 6-part tutorial shows how to build front-end web applications with plain JavaScript, not using any (third-party) framework or library.">Front-End
                              Apps with Plain JS</a></li>
                          <li class="leaf active-trail menu-depth-1 menu-item-465"><a
                              href="../../JavaJpaJsfApp/index.html"
                              title="Learn how to build back-end Java web applications with Java Server Faces (JSF) as the user interface technology, the Java Persistence API (JPA) as the object-to-storage mapping technology, and a MySQL database."
                              class="active-trail active">Back-End Apps with Java EE</a>
                          </li>
                          <li class="leaf menu-depth-1 menu-item-806"><a href="../../mODELcLASSjsApp/index.html"
                              title="Getting rid of boilerplate code with the model-based development approach of mODELcLASSjs.">Apps
                              with mODELcLASSjs </a></li>
                          <li class="leaf menu-depth-1 menu-item-805"><a href="../../WoTProjects/index.html"
                              title="A WoT system is a communication network consisting of sensor nodes, actuator nodes and service nodes connected to the Internet and built with web technologies.">Web
                              of Things (WoT)</a></li>
                          <li class="leaf menu-depth-1 menu-item-613"><a href="../../forum/index.html"
                              title="">Discussion
                              Forums</a>
                          </li>
                          <li class="leaf menu-depth-1 menu-item-720"><a href="../../team/index.html"
                              title="Team members list.">Team</a></li>
                          <li class="last leaf menu-depth-1 menu-item-554"><a
                              href="../../contribute/index.html">Contribute
                              / Support Us</a>
                          </li>
                        </ul>
                      </div>
                    </div>
                  </nav>
                  <section id="block-user-login"
                    class="block block-user even last block-count-5 block-region-sidebar-first block-login" role="form">
                    <div class="block-inner clearfix">
                      <h2 class="block-title">User login</h2>

                      <div class="block-content content">
                        <form action="https://web-engineering.info/node/74?destination=node/74" method="post"
                          id="user-login-form" accept-charset="UTF-8">
                          <div>
                            <div class="form-item form-type-textfield form-item-name">
                              <label for="edit-name">Username <span class="form-required"
                                  title="This field is required.">*</span></label>
                              <input type="text" id="edit-name" name="name" value="" size="15" maxlength="60"
                                class="form-text required" />
                            </div>
                            <div class="form-item form-type-password form-item-pass">
                              <label for="edit-pass">Password <span class="form-required"
                                  title="This field is required.">*</span></label>
                              <input type="password" id="edit-pass" name="pass" size="15" maxlength="128"
                                class="form-text required" />
                            </div>
                            <div class="item-list">
                              <ul>
                                <li class="even first last"><a href="../user/password.html"
                                    title="Request new password via e-mail.">Request new password</a></li>
                              </ul>
                            </div><input type="hidden" name="form_build_id"
                              value="form-jO3PsIbQSZLAmUQYBmpxyMncEuXTVbjOCyEonuX_92Y" />
                            <input type="hidden" name="form_id" value="user_login_block" />
                            <div class="form-actions form-wrapper" id="edit-actions"><input type="submit"
                                id="edit-submit" name="op" value="Log in" class="form-submit" /></div>
                          </div>
                        </form>
                      </div>
                    </div>
                  </section>
                </div>
              </div>
            </div>
          </div>

        </div>
      </div>




    </div>
  </div>
</body>

<!-- Mirrored from web-engineering.info/node/74 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 21 Jul 2023 10:44:35 GMT -->

</html>