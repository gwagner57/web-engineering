<!DOCTYPE html>
<!--[if lt IE 7]><html class="lt-ie9 lt-ie8 lt-ie7" lang="en" dir="ltr"><![endif]-->
<!--[if IE 7]><html class="lt-ie9 lt-ie8" lang="en" dir="ltr"><![endif]-->
<!--[if IE 8]><html class="lt-ie9" lang="en" dir="ltr"><![endif]-->
<!--[if gt IE 8]><!-->
<html lang="en" dir="ltr"
  prefix="fb: http://ogp.me/ns/fb# content: http://purl.org/rss/1.0/modules/content/ dc: http://purl.org/dc/terms/ foaf: http://xmlns.com/foaf/0.1/ og: http://ogp.me/ns# rdfs: http://www.w3.org/2000/01/rdf-schema# sioc: http://rdfs.org/sioc/ns# sioct: http://rdfs.org/sioc/types# skos: http://www.w3.org/2004/02/skos/core# xsd: http://www.w3.org/2001/XMLSchema#">
<!--<![endif]-->

<meta http-equiv="content-type" content="text/html;charset=utf-8" />

<head>
  <meta charset="utf-8" />
  <link rel="shortcut icon" href="../sites/default/files/machine-build-16x16_0.png" type="image/png" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="MobileOptimized" content="width" />
  <meta name="description"
    content="Learn how to develop Arduino-based apps for the Web of Things (WoT). The third part of this series shows how to set up a connection between an Arduino and the Internet via a WiFi network and how to store sensor data using a free cloud service, such as ThingSpeak." />
  <meta name="HandheldFriendly" content="true" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <link rel="canonical" href="62.html" />
  <link rel="shortlink" href="62.html" />
  <title>WoT with Arduino for Beginners: Part 3 - Connecting to the Internet via WiFi | web-engineering.info</title>
  <link rel="stylesheet" href="../../_includes/modules/system/system.base5056.css" type="text/css" media="all">
  <link rel="stylesheet" href="../../_includes/modules/system/system.menus5056.css" type="text/css" media="all">
  <link rel="stylesheet" href="../../_includes/modules/system/system.messages5056.css" type="text/css" media="all">
  <link rel="stylesheet" href="../../_includes/modules/system/system.theme5056.css" type="text/css" media="all">
  <link rel="stylesheet" href="../../_includes/modules/comment/comment5056.css" type="text/css" media="all">
  <link rel="stylesheet" href="../../_includes/modules/field/theme/field5056.css" type="text/css" media="all">
  <link rel="stylesheet" href="../../_includes/modules/node/node5056.css" type="text/css" media="all">
  <link rel="stylesheet" href="../../_includes/modules/search/search5056.css" type="text/css" media="all">
  <link rel="stylesheet" href="../../_includes/modules/user/user5056.css" type="text/css" media="all">
  <link rel="stylesheet" href="../../_includes/modules/forum/forum5056.css" type="text/css" media="all">
  <link rel="stylesheet" href="../../_includes/sites/all/modules/views/css/views5056.css" type="text/css" media="all">
  <link rel="stylesheet" href="../../_includes/sites/all/modules/ckeditor/css/ckeditor5056.css" type="text/css"
    media="all">
  <link rel="stylesheet" href="../../_includes/sites/all/modules/ctools/css/ctools5056.css" type="text/css" media="all">
  <link rel="stylesheet"
    href="../../_includes/sites/all/themes/adaptivetheme/at_core/css/at.settings.style.headings5056.css" type="text/css"
    media="screen">
  <link rel="stylesheet"
    href="../../_includes/sites/all/themes/adaptivetheme/at_core/css/at.settings.style.image5056.css" type="text/css"
    media="screen">
  <link rel="stylesheet" href="../../_includes/sites/all/themes/adaptivetheme/at_core/css/at.layout5056.css"
    type="text/css" media="screen">
  <link rel="stylesheet" href="../../_includes/sites/all/themes/corolla/css/webeng.custom5056.css" type="text/css"
    media="all">
  <link rel="stylesheet" href="../../_includes/sites/all/themes/corolla/css/html-elements5056.css" type="text/css"
    media="all">
  <link rel="stylesheet" href="../../_includes/sites/all/themes/corolla/css/forms5056.css" type="text/css" media="all">
  <link rel="stylesheet" href="../../_includes/sites/all/themes/corolla/css/tables5056.css" type="text/css" media="all">
  <link rel="stylesheet" href="../../_includes/sites/all/themes/corolla/css/page5056.css" type="text/css" media="all">
  <link rel="stylesheet" href="../../_includes/sites/all/themes/corolla/css/articles5056.css" type="text/css"
    media="all">
  <link rel="stylesheet" href="../../_includes/sites/all/themes/corolla/css/comments5056.css" type="text/css"
    media="all">
  <link rel="stylesheet" href="../../_includes/sites/all/themes/corolla/css/fields5056.css" type="text/css" media="all">
  <link rel="stylesheet" href="../../_includes/sites/all/themes/corolla/css/blocks5056.css" type="text/css" media="all">
  <link rel="stylesheet" href="../../_includes/sites/all/themes/corolla/css/navigation5056.css" type="text/css"
    media="all">
  <link rel="stylesheet" href="../../_includes/sites/all/themes/corolla/css/corolla.settings.style5056.css"
    type="text/css" media="all">
  <link rel="stylesheet" href="../../_includes/sites/all/themes/corolla/color/colors5056.css" type="text/css"
    media="all">
  <link rel="stylesheet" href="../../_includes/sites/all/themes/corolla/css/print5056.css" type="text/css"
    media="print">
  <link type="text/css" rel="stylesheet"
    href="../../_includes/sites/default/files/adaptivetheme/corolla_files/corolla.responsive.layout5056.css"
    media="only screen" />
  <link rel="stylesheet" href="../../_includes/sites/default/files/adaptivetheme/corolla_files/corolla.fonts5056.css"
    type="text/css" media="screen">
  <link type="text/css" rel="stylesheet" href="../../_includes/sites/all/themes/corolla/css/responsive.custom5056.css"
    media="only screen" />
  <link type="text/css" rel="stylesheet"
    href="../../_includes/sites/all/themes/corolla/css/responsive.smartphone.portrait5056.css"
    media="only screen and (max-width:320px)" />
  <link type="text/css" rel="stylesheet"
    href="../../_includes/sites/all/themes/corolla/css/responsive.smartphone.landscape5056.css"
    media="only screen and (min-width:321px) and (max-width:480px)" />
  <link type="text/css" rel="stylesheet"
    href="../../_includes/sites/all/themes/corolla/css/responsive.tablet.portrait5056.css"
    media="only screen and (min-width:481px) and (max-width:768px)" />
  <link type="text/css" rel="stylesheet"
    href="../../_includes/sites/all/themes/corolla/css/responsive.tablet.landscape5056.css"
    media="only screen and (min-width:769px) and (max-width:1024px)" />
  <link type="text/css" rel="stylesheet" href="../../_includes/sites/all/themes/corolla/css/responsive.desktop5056.css"
    media="only screen and (min-width:1025px)" />


  <!--[if lt IE 9]>
    <style type="text/css" media="screen">
    @import url("../../_includes/sites/default/files/adaptivetheme/corolla_files/corolla.lt-ie9.layout.css?qv28dn");
    </style>
    <![endif]-->

  <!--[if lte IE 9]>
    <style type="text/css" media="screen">
    @import url("../../_includes/sites/all/themes/corolla/css/ie-lte-9.css?qv28dn");
    </style>
    <![endif]-->
  <script type="text/javascript" src="../../_includes/misc/jquery1cc4.js"></script>
  <script type="text/javascript" src="../../_includes/misc/jquery-extend-3.4.01cc4.js"></script>
  <script type="text/javascript" src="../../_includes/misc/jquery.once7839.js"></script>
  <script type="text/javascript" src="../../_includes/misc/drupal5056.js"></script>
  <script type="text/javascript"
    src="../../_includes/sites/all/modules/google_analytics/googleanalytics5056.js"></script>
  <script type="text/javascript">
    <!--//-->
  < ![CDATA[//><!--
      (function (i, s, o, g, r, a, m) { i["GoogleAnalyticsObject"] = r; i[r] = i[r] || function () { (i[r].q = i[r].q || []).push(arguments) }, i[r].l = 1 * new Date(); a = s.createElement(o), m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m) })(window, document, "script", "https://www.google-analytics.com/analytics.js", "ga"); ga("create", "UA-48105674-1", { "cookieDomain": "auto" }); ga("set", "anonymizeIp", true); ga("send", "pageview");
    //--><!]]>
  </script>
  <script type="text/javascript" src="../../_includes/sites/all/modules/disqus/disqus5056.js"></script>
  <script type="text/javascript">
    <!--//-->
  < ![CDATA[//><!--
        jQuery.extend(Drupal.settings, { "basePath": "\/", "pathPrefix": "", "ajaxPageState": { "theme": "corolla", "theme_token": "lFZahT6-VB7Qy37XiPt4hR1WARBvKq95YLAdjNylpqc", "js": { "misc\/jquery.js": 1, "misc\/jquery-extend-3.4.0.js": 1, "misc\/jquery.once.js": 1, "misc\/drupal.js": 1, "sites\/all\/modules\/google_analytics\/googleanalytics.js": 1, "0": 1, "sites\/all\/modules\/disqus\/disqus.js": 1 }, "css": { "modules\/system\/system.base.css": 1, "modules\/system\/system.menus.css": 1, "modules\/system\/system.messages.css": 1, "modules\/system\/system.theme.css": 1, "modules\/comment\/comment.css": 1, "modules\/field\/theme\/field.css": 1, "modules\/node\/node.css": 1, "modules\/search\/search.css": 1, "modules\/user\/user.css": 1, "modules\/forum\/forum.css": 1, "sites\/all\/modules\/views\/css\/views.css": 1, "sites\/all\/modules\/ckeditor\/css\/ckeditor.css": 1, "sites\/all\/modules\/ctools\/css\/ctools.css": 1, "sites\/all\/themes\/adaptivetheme\/at_core\/css\/at.settings.style.headings.css": 1, "sites\/all\/themes\/adaptivetheme\/at_core\/css\/at.settings.style.image.css": 1, "sites\/all\/themes\/adaptivetheme\/at_core\/css\/at.layout.css": 1, "sites\/all\/themes\/corolla\/css\/webeng.custom.css": 1, "sites\/all\/themes\/corolla\/css\/html-elements.css": 1, "sites\/all\/themes\/corolla\/css\/forms.css": 1, "sites\/all\/themes\/corolla\/css\/tables.css": 1, "sites\/all\/themes\/corolla\/css\/page.css": 1, "sites\/all\/themes\/corolla\/css\/articles.css": 1, "sites\/all\/themes\/corolla\/css\/comments.css": 1, "sites\/all\/themes\/corolla\/css\/fields.css": 1, "sites\/all\/themes\/corolla\/css\/blocks.css": 1, "sites\/all\/themes\/corolla\/css\/navigation.css": 1, "sites\/all\/themes\/corolla\/css\/fonts.css": 1, "sites\/all\/themes\/corolla\/css\/corolla.settings.style.css": 1, "sites\/all\/themes\/corolla\/color\/colors.css": 1, "sites\/all\/themes\/corolla\/css\/print.css": 1, "public:\/\/adaptivetheme\/corolla_files\/corolla.responsive.layout.css": 1, "public:\/\/adaptivetheme\/corolla_files\/corolla.fonts.css": 1, "sites\/all\/themes\/corolla\/css\/responsive.custom.css": 1, "sites\/all\/themes\/corolla\/css\/responsive.smartphone.portrait.css": 1, "sites\/all\/themes\/corolla\/css\/responsive.smartphone.landscape.css": 1, "sites\/all\/themes\/corolla\/css\/responsive.tablet.portrait.css": 1, "sites\/all\/themes\/corolla\/css\/responsive.tablet.landscape.css": 1, "sites\/all\/themes\/corolla\/css\/responsive.desktop.css": 1, "public:\/\/adaptivetheme\/corolla_files\/corolla.lt-ie9.layout.css": 1, "sites\/all\/themes\/corolla\/css\/ie-lte-9.css": 1 } }, "googleanalytics": { "trackOutbound": 1, "trackMailto": 1, "trackDownload": 1, "trackDownloadExtensions": "7z|aac|arc|arj|asf|asx|avi|bin|csv|doc(x|m)?|dot(x|m)?|exe|flv|gif|gz|gzip|hqx|jar|jpe?g|js|mp(2|3|4|e?g)|mov(ie)?|msi|msp|pdf|phps|png|ppt(x|m)?|pot(x|m)?|pps(x|m)?|ppam|sld(x|m)?|thmx|qtm?|ra(m|r)?|sea|sit|tar|tgz|torrent|txt|wav|wma|wmv|wpd|xls(x|m|b)?|xlt(x|m)|xlam|xml|z|zip" }, "urlIsAjaxTrusted": { "\/search\/node": true, "\/index.html?destination=node\/5": true }, "disqus": { "domain": "web-engineering", "url": "https:\/\/web-engineering.info\/index.html", "title": "Free Tutorials and Books with the Complete Code of Example Apps", "identifier": "node\/5" }, "adaptivetheme": { "corolla": { "layout_settings": { "bigscreen": "three-col-grail", "tablet_landscape": "three-col-grail", "tablet_portrait": "one-col-vert", "smalltouch_landscape": "one-col-vert", "smalltouch_portrait": "one-col-stack" }, "media_query_settings": { "bigscreen": "only screen and (min-width:1025px)", "tablet_landscape": "only screen and (min-width:769px) and (max-width:1024px)", "tablet_portrait": "only screen and (min-width:481px) and (max-width:768px)", "smalltouch_landscape": "only screen and (min-width:321px) and (max-width:480px)", "smalltouch_portrait": "only screen and (max-width:320px)" } } } });
    //--><!]]>
  </script>
  <!--[if lt IE 9]>
    <script src="../../_includes/sites/all/themes/adaptivetheme/at_core/scripts/html5.js?qv28dn"></script>
    <![endif]-->
</head>

<body
  class="html not-front not-logged-in one-sidebar sidebar-first page-node page-node- page-node-62 node-type-blog atr-7.x-3.x atv-7.x-3.1 site-name-web-engineeringinfo section-node color-scheme-default corolla bs-n bb-n mb-dd rc-6 rct-6">
  <div id="skip-link" class="nocontent">
    <a href="#main-content" class="element-invisible element-focusable">Skip to main content</a>
  </div>
  <div id="page-wrapper">
    <div id="page"
      class="page snc-n snw-n sna-l sns-n ssc-n ssw-n ssa-l sss-n btc-n btw-b bta-l bts-n ntc-n ntw-b nta-l nts-n ctc-n ctw-b cta-l cts-n ptc-n ptw-b pta-l pts-n">


      <div id="header-wrapper">
        <div class="container clearfix">

          <header class="clearfix with-logo" role="banner">

            <div id="branding" class="branding-elements clearfix">

              <div id="logo">
                <a href="../../index.html"><img class="site-logo" typeof="foaf:Image"
                    src="../sites/default/files/logo_1.png" alt="web-engineering.info" /></a>
              </div>

              <div class="h-group" id="name-and-slogan">

                <h1 id="site-name"><a href="../../index.html" title="Home page">web-engineering.info</a></h1>

                <h2 id="site-slogan">High-quality resources for learning developers and makers</h2>

              </div>

            </div>


          </header>

        </div>
      </div>




      <div id="content-wrapper">
        <div class="container">

          <div id="columns">
            <div class="columns-inner clearfix">

              <div id="content-column">
                <div class="content-inner">


                  <section id="main-content" role="main">


                    <div class="content-margin">
                      <div class="content-style">


                        <div id="breadcrumb" class="clearfix">
                          <nav class="breadcrumb-wrapper clearfix" role="navigation" aria-labelledby="breadcrumb-label">
                            <h2 id="breadcrumb-label" class="element-invisible">You are here</h2>
                            <ol id="crumbs" class="clearfix">
                              <li class="crumb crumb-first"><span typeof="v:Breadcrumb"><a rel="v:url"
                                    property="v:title" href="../../blog/index.html">Blogs</a></span></li>
                              <li class="crumb crumb-last"><span class="crumb-separator"> &#187; </span><span
                                  typeof="v:Breadcrumb"><a rel="v:url" property="v:title"
                                    href="../blog/24.html">mdiaconescu&#039;s blog</a></span></li>
                            </ol>
                          </nav>
                        </div>

                        <header class="clearfix">
                          <h1 id="page-title">
                            WoT with Arduino for Beginners: Part 3 - Connecting to the Internet via WiFi </h1>
                        </header>



                        <div id="content">
                          <div class="region region-content">
                            <div id="block-easy-social-easy-social-block-1"
                              class="block block-easy-social no-title odd first block-count-1 block-region-content block-easy-social-block-1">

                              <div class="easy_social_box clearfix horizontal easy_social_lang_en">
                                <div class="easy_social-widget easy_social-widget-twitter first"><a
                                    href="https://twitter.com/share" class="twitter-share-button"
                                    data-url="https://web-engineering.info/node/62" data-count="horizontal"
                                    data-lang="en" data-via="" data-related=":Check it out!"
                                    data-text="web-engineering.info">Tweet</a></div>
                                <div class="easy_social-widget easy_social-widget-facebook">
                                  <fb:like href="62.html" send="true" layout="button_count" width="88" show_faces="true"
                                    action="https://web-engineering.info/node/like" colorscheme="light" font="">
                                  </fb:like>
                                </div>
                                <div class="easy_social-widget easy_social-widget-googleplus">
                                  <div class="g-plusone" data-size="medium" data-annotation="bubble"
                                    data-href="https://web-engineering.info/node/62"></div>
                                </div>
                                <div class="easy_social-widget easy_social-widget-linkedin last">
                                  <script type="in/share" data-url="https://web-engineering.info/node/62"
                                    data-counter="right"></script>
                                </div>
                              </div> <!-- /.easy_social_box -->
                            </div>
                            <div id="block-system-main"
                              class="block block-system no-title even last block-count-2 block-region-content block-main">

                              <article id="node-62"
                                class="node node-blog node-promoted article odd node-with-picture node-full ia-n clearfix"
                                about="/node/62" typeof="sioc:Post sioct:BlogPost" role="article">
                                <div class="node-inner">


                                  <header class="node-header">


                                    <p class="submitted"><span property="dc:date dc:created"
                                        content="2016-04-20T16:46:57+02:00" datatype="xsd:dateTime"
                                        rel="sioc:has_creator">Submitted by <a href="../user/24.html"
                                          title="View user profile." class="username" xml:lang="" about="/user/24"
                                          typeof="sioc:UserAccount" property="foaf:name" datatype="">mdiaconescu</a> on
                                        <time datetime="2016-04-20T16:46:57+0200">Wed, 04/20/2016 - 16:46</time></span>
                                    </p>

                                  </header>
                                  <span property="dc:title"
                                    content="WoT with Arduino for Beginners: Part 3 - Connecting to the Internet via WiFi"
                                    class="rdf-meta element-hidden"></span><span property="sioc:num_replies" content="0"
                                    datatype="xsd:integer" class="rdf-meta element-hidden"></span>
                                  <div class="node-content">
                                    <div class="user-picture">
                                      <a href="../user/24.html" title="View user profile."><img typeof="foaf:Image"
                                          class="image-style-thumbnail"
                                          src="../sites/default/files/styles/thumbnail/public/pictures/picture-24-144421814220be.jpg?itok=q_Sm9CHc"
                                          alt="mdiaconescu&#039;s picture" title="mdiaconescu&#039;s picture" /></a>
                                    </div>
                                    <div
                                      class="field field-name-body field-type-text-with-summary field-label-hidden view-mode-full">
                                      <div class="field-items">
                                        <div class="field-item even" property="content:encoded">
                                          <p>In this multi-part tutorial we show how to develop Arduino-based apps for
                                            the Web of Things (WoT). This third part shows how to set up a connection
                                            between an Arduino and the Internet via a WiFi network and use HTTP(S) to
                                            send data to a free cloud service like <a
                                              href="https://thingspeak.com/">ThingSpeak</a>. In the following parts of
                                            this tutorial, which will appear every 1-3 weeks, we discuss how to control
                                            actuators and connect them all together in a Web of Things (WoT) app. Using
                                            standard Web technologies, such as HTTP and Web Sockets, we can then access
                                            the data or provide commands to the WoT nodes. As a newbie, it is helpful if
                                            you already have some familiarity with C/C++ programming and Web
                                            technologies, such as HTML and JavaScript.</p>

                                          <p>You may first want tor read the previous parts of this tutorial series:</p>

                                          <ul>
                                            <li><a href="60.html">Part 1: Mastering the RGB LED</a></li>
                                            <li><a href="61.html">Part 2: Connecting to the Real World via Sensors</a>
                                            </li>
                                          </ul>

                                          <p>This tutorial is part of our <a href="../../WoTProjects/index.html">learning
                                              materials</a> on the Web of Things published on <a
                                              href="../../index.html">web-engineeering.info</a>.</p>

                                          <p><small><strong>Disclaimer:</strong> working with electricity is dangerous.
                                              For this project we'll use 5V, which is safe for the human body under any
                                              environment conditions. However, the low voltage may be obtained from a
                                              mains connected power brick, and therefore we highly recommend you to take
                                              safety precautions and to use a trustful brand for the power supply. We
                                              cannot be held responsible for any caused damage! Do it at your own risk
                                              and/or ask help from an electronics engineer. In case you are using the
                                              USB connector from your PC to power the Arduino board, be aware that
                                              short-circuits which may occur on the Arduino board may also have a
                                              negative impact on your PC!</small></p>

                                          <p><small><strong>Credits:</strong> some of the images from this tutorial are
                                              created by using <a href="http://fritzing.org/home/">Fritzing</a>, a nice
                                              electronics modeling tool for beginners.</small></p>

                                          <p><button>Download the Source Code for this project</button></p>

                                          <h2>Arduino + ESP8266 = "I'm online, Mum!"</h2>

                                          <p>After we've managed to read data from the environment using sensors, we
                                            want to store the data for later use, such as statistical analysis or
                                            visualization. It would also be nice to if we could watch what's going on at
                                            the monitored site even when we are not around, by going to a website that
                                            provides access to the (current and historical) sensor data.</p>

                                          <p>An Arduino can be connected to a network, and thus to the Internet, by
                                            using various networking modules, e.g., standard WiFi, wired Ethernet or
                                            Bluetooth, see <a href="#fig1">Figure 1</a>. Other custom solutions are also
                                            available, such as for example RF modules that communicate in the
                                            315MHz-2.4GHz frequency range. However, such modules do not use the standard
                                            WiFi protocols, therefore you can't use them for directly connecting your
                                            Arduino to the Internet by simply using your WiFi router or repeater.</p>

                                          <figure id="fig1"><img alt="Network Connection Modules for Arduino"
                                              src="../sites/default/files/wot_tutorials/networking/network-modules.png" />
                                            <figcaption>Figure 1: Network Connection Modules for Arduino.</figcaption>
                                          </figure>

                                          <p>A simple solution for having an Arduino connected to a WiFi network, and
                                            thus to the Internet, is to use an ESP8266 module. These modules are now
                                            widely available, with prices in the range of 2-8 EUR, including postage to
                                            the EU. Such a module is what we are going to use in this tutorial, and we
                                            intend to provide you with a guide on how to chose one, since multiple
                                            variants are available, how to update its firmware, since new versions are
                                            available almost every month, and how to use it to transmit and receive data
                                            by using standard Web technologies, such as HTTP(S).</p>

                                          <h3>Choosing an ESP8266 Module Version</h3>

                                          <p>Multiple versions of the ESP8266 WiFi module are available, we are aware
                                            about 12 of them, as shown in <a href="#fig2">Figure 2</a>.</p>

                                          <figure id="fig2"><img alt="Variants of the ESP8266 WiFi Module"
                                              src="../sites/default/files/wot_tutorials/networking/esp8266-variants.png" />
                                            <figcaption>Figure 2: Variants of the ESP8266 WiFi Module.</figcaption>
                                          </figure>

                                          <p>These modules use the 802.11b/g/n standard, operating at 2.4 GHz. This
                                            means, we can connect to a standard WiFi network, such as the one most of us
                                            have at home, provided by an WiFi router or access point (AP).</p>

                                          <p>Having multiple variants of ESP8266 module, comes the question: "which one
                                            should I use ?". There is no perfect answer for this question, and it highly
                                            depends on what you are using the WiFi module for. These modules are not
                                            only a "blind" WiFi communication module, but are based on a MCU, which can
                                            be programmed and which have I/O pins, therefore it can do tasks similar
                                            with the ones available for the Arduino boards. Even more, the Arduino IDE
                                            supports ESP8266 programming, but details about this topic we'll discus in
                                            another tutorial. Regarding our question, there are three main reasons to
                                            consider when choosing an ESP8266 module:</p>

                                          <ul>
                                            <li><strong>usability on a breadboard:</strong> most of the times we
                                              prototype on a breadboard, therefore we should be able to connect these
                                              modules to such a board. Some of the modules, such as ESP02, ESP03 and
                                              ESP05 (see <a href="#fig2">Figure 2</a>) are breadboard friendly, having a
                                              pitch of 2.54mm (the distance between two pins). Other modules, such as
                                              ESP07 or ESP08 have a pitch of 1.27mm, thus you'll only be able to use
                                              them with a breadboard when using an adapter. Last, other modules, such as
                                              ESP01 have a pitch of 2.54mm, but they have a two-row header, which makes
                                              it impossible to use it with a breadboard, because the implied
                                              short-circuit between the pins. Notice that some of the breadboard
                                              friendly modules have only a half-way pin connections, see ESP02 module
                                              from <a href="#fig2">Figure 2</a>. Such connections are somehow harder to
                                              solder, specially for a beginner. Our tip: plug the pin headers into a
                                              breadboard, align the module on top of them, then solder.</li>
                                            <li><strong>flash memory size:</strong> this is very important to consider
                                              when choosing an ESP8266 module, because they come with permanent flash
                                              memory, which is usually in the range of 4MBit (512KB) up to 16MBit (2MB),
                                              but can go up to 128MBit (16MB). <em><strong>Starting with the firmware
                                                  version 1.1.0 (released on June 2015), you'll need a module with at
                                                  least 8MBit (1MB) flash size to burn the new firmware</strong></em>.
                                              Thus, pay attention when buy the module and be sure that you get one that
                                              has at least 8Mbit (1MB) flash size. In term of RAM and MCU frequency,
                                              they are mostly the same, so no need to worry about it. There are ways to
                                              improve the flash capacity, but for this you'll need good soldering skills
                                              to remove the old flash IC and solder the new one, and usually the price
                                              of the flash IC bought in small quantities is more than half of the
                                              ESP8266 module price, thus defeating the purpose. Excepting for the ESP06,
                                              ESP07, ESP08 and ESP12 modules, which have a metallic (hard to remove)
                                              cover over the CPU and flash IC, you can simply detect the flash size by
                                              reading the text on the 8 pin black IC soldered near the MCU (which is the
                                              square black IC with pins on all four sides). If the number on the flash
                                              IC starts with 25Q80 then you have a 8MBit sized one, while if it starts
                                              with 25Q40 then you have a 4MBit sized one.</li>
                                            <li><strong>MCU features:</strong> these modules are driven by a low power
                                              32-bit RISC CPU (Tensilica Xtensa LX106) running at 80 MHz. It has 64 KB
                                              of instruction RAM, 96 KB of data RAM and supports external QSPI flash -
                                              512 KB to 4 MB (up to 16MB is supported). I has 16 I/O pins, from which
                                              one has 10Bit ADC capabilities, and supports I2C, I2S, SPI and UART
                                              communication protocols. All these features are quite important if you are
                                              using the ESP8266 module as standalone controller board. However, if the
                                              ESP8266 module is used as WiFi interface only, then you'll not need these
                                              features, and you can chose the cheapest and board with suits your needs.
                                            </li>
                                          </ul>

                                          <p>Based on the above considerations, we chose to use ESP02 module, because it
                                            is small, breadboard friendly (even if is not very easy to solder the pin
                                            header) and it has a connector for a 2.4GHz WiFi antenna, thus allowing for
                                            a good WiFi range, even when used indoors.</p>

                                          <h3>Update the ESP8266 Firmware</h3>

                                          <p><strong>Disclaimer:</strong> perform the tasks shown on this section on
                                            your own risk. If something goes wrong, it may be possible to have a
                                            "bricked" module, which can't be used anymore or requires special tools to
                                            repair.</p>

                                          <p>Normally, after buying an ESP8266 module, the first task is to ensure that
                                            it has the latest firmware, thus being able to use the latest features and
                                            having fixed various software related problems. But how do we know if the
                                            last firmware is burned into our ESP8266 module? To answer this question we
                                            need to connect the module to a computer by using a TTL module and a
                                            software, which allows us to communicate with the module and perform queries
                                            or provide commands. A TTL module (e.g. see <a href="#fig3">Figure 3</a>),
                                            see is a communication device that connects to an USB port of the computer
                                            and allows to map Serial protocol via the USB port. Its TX and RX pins
                                            connects to the RX and respective TX pins of the ESP8266 module (pay
                                            attention, the pins connection is twisted!). Such modules are quite cheap,
                                            having an approximate cost of about 2-3 EUR postage included in EU.</p>

                                          <figure id="fig3"><img alt="USB-TTL UART Module"
                                              src="../sites/default/files/wot_tutorials/networking/usb-ttl-module.png" />
                                            <figcaption>Figure 3: USB-TTL UART Module.</figcaption>
                                          </figure>

                                          <p>In <a href="#fig4">Figure 4</a> and <a href="#fig5">Figure 5</a> are shown
                                            the breadboard connection and the schematics of the circuit which allows us
                                            to have the ESP02 module communicating with a computer by using the serial
                                            port (UART communcation). A breadboard friendly power supply is used to
                                            provide the required 3.3V for the ESP8266 module. This specific one allows
                                            inputs in the range 5-12V and produce a steady 3.3V or 5V (a switch allows
                                            the selection) output, with a maximum current of 0.5A.</p>

                                          <p>In addition, we need a software which allows us to have a user interface so
                                            we can send commands (or queries) to the module and see the module answer.
                                            While there are multiple software available for this purpose, we found <a
                                              href="http://realterm.sourceforge.net/">Realterm</a> as being very stable,
                                            free of charge and easy to use. Further in this tutorial we refer to
                                            Realterm when providing examples or screen shots related to this topic, but
                                            you are free to use others if you like, such as for example <a
                                              href="https://www.putty.org/"> Putty</a>.</p>

                                          <figure id="fig4"><img
                                              alt="ESP8266 PC USB Connection via TTL Module on a Breadboard"
                                              src="../sites/default/files/wot_tutorials/networking/usb-ttl-esp8266-breadboard.png" />
                                            <figcaption>Figure 4: ESP8266 PC USB Connection via TTL Module on a
                                              Breadboard.</figcaption>
                                          </figure>

                                          <figure id="fig5"><img
                                              alt="Schematics of ESP8266 PC USB Connection via TTL Module"
                                              src="../sites/default/files/wot_tutorials/networking/usb-ttl-esp8266-schematics.png" />
                                            <figcaption>Figure 5: Schematics of ESP8266 PC USB Connection via TTL
                                              Module.</figcaption>
                                          </figure>

                                          <p>It may be observed that two of the ESP8266 module pins are connected to VCC
                                            (3.3V) via 3.3kâ„¦ resistors. This is required, because the RST (reset) and
                                            CH_PD (power down) pins must stay high during the normal operation of this
                                            module. One can use Arduino I/O pins to control the state of these pins,
                                            thus having reset and power down features for a project that implies to use
                                            the ESP8266 module, and allowing for lower energy consumption when WiFi
                                            transmission is not required. The ESP8266 module is able to recover very
                                            fast from a "power down" state, the wake-up time being in the order of
                                            milliseconds. However, after resetting the module, may take up to two
                                            seconds to have the module booted and a few other seconds until WiFi line is
                                            ready to be used.</p>

                                          <p><strong>Important:</strong> the connection between the GPIO0 of the ESP8266
                                            module and GND (see the blue wire in <a href="#fig4">Figure 4</a>) is
                                            required when the firmware needs to be updated. In all the other case, you
                                            should remove this connection, otherwise your module will not communicate
                                            via the UART port (RX/TX lines). Removing or connecting GPIO0 pin to GND
                                            should be done ONLY when the module receives no power, so first turn OFF the
                                            power supply connected to module, then connect or disconnect the wire (or
                                            jumper) between the GPIO0 to GND.</p>

                                          <p>The USB-TTL module we use has a 3.3V UART interface, therefore is no need
                                            to have an additional voltage LC (level converter) module. Before doing the
                                            connections, check if your module has already this feature, by measuring
                                            (using a voltmeter) the voltage between the GND and TX pins of the USB-TTL
                                            module. If you read a voltage value under 3.5V, then it is safe to connect
                                            the RX and TX pins of the USB-TTL module directly to the ESP8266 TX and RX
                                            pins. If you read more than 3.5V then you need to use a LC module to convert
                                            the 5V to 3.3V and back between the RX and TX lines of the ESP8266 module
                                            and the USB-TTL module. Ignoring this advice may result in a broken ESP8266
                                            module, so do it at your own risk!</p>

                                          <p><strong>Note:</strong> it is strongly recommended to use a stable 3.3V
                                            power supply, which is able to provide current in excess of 500mA (0.5A).
                                            The ESP8266 module is in general power efficient, but during the data
                                            transmission, it may have peaks of up to 500mA. Powering it from the 3.3V
                                            rail of the Aruino board or from the 3.3V rail available for some USB-TTL
                                            module is NOT recommended and will very likely result in destroying the 3.3V
                                            voltage regulator of your Arduino board or of the USB-TTL board. We use a
                                            breadboard friendly power supply, able to provide 3.3V and 5V (a switch
                                            allow the selection) at up to 500mA (see <a href="#fig4">Figure 4</a>). This
                                            specific power supply cab be found very cheap, having prices of about 1-3
                                            EUR postage in EU included.</p>

                                          <p>After you have downloaded and installed <a
                                              href="http://realterm.sourceforge.net/">Realterm</a>, start it and select
                                            the baud rate (normally this defaults to 115200 for most of the ESP8266
                                            modules we bought over the last 6 months) and the COM port (which in our
                                            case is 38, but may be different for you, so better check). Last, push the
                                            "Open" button, to create a Serial (UART) connection. If the "Open" button
                                            was already pushed, then push it again to its OFF state it and push it back
                                            to its ON state. Also, check <a href="#fig6">Figure 6</a> for additional
                                            information.</p>

                                          <p><strong>Note:</strong> Realterm is highly configurable via command line
                                            parameters. Check the <a
                                              href="http://realterm.sourceforge.net/index.html#Command_Line_Parameters">command
                                              line configuration parameters</a> documentation for making your settings
                                            permanent (e.g., to have the program started with the COM port and baud-rate
                                            already set to whatever you like) or for having various other
                                            configurations.</p>

                                          <figure id="fig6"><img alt="Realterm Port and Baud-rate configuation"
                                              src="../sites/default/files/wot_tutorials/networking/esp8266-FU-connect.png" />
                                            <figcaption>Figure 6: Realterm Port and Baud-rate configuation.</figcaption>
                                          </figure>

                                          <p>At this moment we are ready to communicate with the ESP8266 module. First
                                            operation we like to perform is a reset, so we are able to see that the
                                            module reacts to our commands. For this, go to "Send" tab in Realterm UI and
                                            write "AT+RST" on the first text input box. Please check the "+CR" and "+LF"
                                            boxes located on the right of the first text input box, thus allowing to
                                            send a CR and LF chars at the end of the command, allowing the ESP8266
                                            module to detect a "command end" limiter. You should see a result similar
                                            with the one shown in <a href="#fig7">Figure 7</a>, but some of the response
                                            text may differ in your case because of different firmware versions.</p>

                                          <figure id="fig7"><img alt="Sending Reset Command to ESP8266 Module"
                                              src="../sites/default/files/wot_tutorials/networking/esp8266-AT%2bRST-before.png" />
                                            <figcaption>Figure 7: Sending Reset Command to ESP8266 Module.</figcaption>
                                          </figure>

                                          <p>Our initial purpose was to check if we have (or not) the latest firmware
                                            burned int our ESP8266 module. For this, following the same procedure as for
                                            "AT+RST" command, we send the "AT+GMR" command. Tee result we obtain is
                                            shown in <a href="#fig8">Figure 8</a> but you may have a different one,
                                            because of a different firmware version burned into your module.</p>

                                          <figure id="fig8"><img alt="Sending 'Get Version' Command to ESP8266 Module"
                                              src="../sites/default/files/wot_tutorials/networking/esp8266-AT%2bGMR-before.png" />
                                            <figcaption>Figure 8: Sending 'Get Version' Command to ESP8266 Module.
                                            </figcaption>
                                          </figure>

                                          <p>As shown in <a href="#fig8">Figure 8</a>, the SDK firmware version of our
                                            module 1.3.0 and the AT version is 0.40.0, which are quite old (see also the
                                            date, is 8 August 2015!). Check if there is any available firmware update by
                                            navigating to <a
                                              href="http://bbs.espressif.com/">http://bbs.espressif.com/</a> and look at
                                            the "SDK" section. We found that the current available firmware update is
                                            SDK version 1.5.3 and the current AT version is 1.1.0 (dated 16 April 2016).
                                          </p>

                                          <p>Download the firmware following the links provided in the SDK download
                                            page, then unzip the archive somewhere on your PC hard drive. Open the
                                            ESP8266Flasher tool, available as download in the archive attached to this
                                            tutorial. Now follow the instructions shown in <a href="#fig9">Figure 9</a>,
                                            <a href="#fig10">Figure 10</a> and <a href="#fig11">Figure 11</a> to
                                            configure the tool for firmware update. Notice that in <a
                                              href="#fig10">Figure 10</a>, we have selected 1MB because our ESP02 module
                                            has a 8MBit (1MB) flash IC, but you should do the appropriate selection for
                                            your module if the flash IC is different. However, a flash IC with a size
                                            smaller than 1MB <strong>will not work</strong>, since the current firmware
                                            version is to big to fit. Such a module cannot be upgraded to a firmware
                                            version greater than 1.1.0 (which is quite old and misses a lot of features,
                                            so go and break your piggy bank and buy an appropriate ESP8266 module!).
                                          </p>

                                          <p><strong>Note:</strong> the ESP8266 firmware update tool, as well as the
                                            current version of the ESP8266 firmware is part of the download archive we
                                            provide with this article. However, new firmware versions may be released at
                                            anytime, so better check the <a
                                              href="http://bbs.espressif.com/">http://bbs.espressif.com/</a> for being
                                            sure that you get the latest version.</p>

                                          <figure id="fig9"><img alt="Select Firmware Update Binaries"
                                              src="../sites/default/files/wot_tutorials/networking/esp8266-FU-config.png" />
                                            <figcaption>Figure 9: Select Firmware Update Binaries.</figcaption>
                                          </figure>

                                          <figure id="fig10"><img
                                              alt="Select Flash Size and Baudrate for Firmware Update"
                                              src="../sites/default/files/wot_tutorials/networking/esp8266-FU-advanced.png" />
                                            <figcaption>Figure 10: Select Flash Size and Baudrate for Firmware Update.
                                            </figcaption>
                                          </figure>

                                          <figure id="fig11"><img alt="Select COM Port for Firmware Update"
                                              src="../sites/default/files/wot_tutorials/networking/esp8266-FU-operation.png" />
                                            <figcaption>Figure 11: Select COM Port for Firmware Update.</figcaption>
                                          </figure>

                                          <p>Last, start the firmware update by pushing the "Flash" button, shown in <a
                                              href="#fig11">Figure 11</a>. If all was correctly configure, you should
                                            see now the "AP MAC" and "STA MAC" fields (shown in <a href="#fig11">Figure
                                              11</a>) filled in with values (as shown in <a href="#fig12">Figure
                                              12</a>), and the blue bar starts to fill in, showing the progress (see <a
                                              href="#fig12">Figure 12</a>).</p>

                                          <figure id="fig12"><img alt="Firmware Update in Progress"
                                              src="../sites/default/files/wot_tutorials/networking/esp8266-FU-updating.png" />
                                            <figcaption>Figure 12: Firmware Update in Progress.</figcaption>
                                          </figure>

                                          <p>The update may take about a minute or two, and at the end, the
                                            ESP8266Flasher UI should look similar with <a href="#fig13">Figure 13</a>.
                                          </p>

                                          <figure id="fig13"><img alt="Firmware Update Completed"
                                              src="../sites/default/files/wot_tutorials/networking/esp8266-FU-updated.png" />
                                            <figcaption>Figure 13: Firmware Update Completed.</figcaption>
                                          </figure>

                                          <p>At this point, you'll need to power down the ESP8266 module (disconnect the
                                            power supply), and remove the connection between the GPIO0 pin and GND, so
                                            the module does not enter firmware upgrade mode when powered up. Missing
                                            this step results in a non communicative module, therefore not responding to
                                            commands and looking as a broken one, software wise.</p>

                                          <p>Start the Realterm, make the port configurations (discussed earlier in this
                                            section) and run the "AT+RST" command and then the "AT+GMR" command and
                                            check the results. If all went well, you should see results similar with the
                                            ones shown in <a href="#fig14">Figure 14</a> and <a href="#fig15">Figure
                                              15</a>.</p>

                                          <figure id="fig14"><img alt="Sending Reset Command to ESP8266 Module"
                                              src="../sites/default/files/wot_tutorials/networking/esp8266-AT%2bRST-after.png" />
                                            <figcaption>Figure 14: Sending Reset Command to ESP8266 Module.</figcaption>
                                          </figure>

                                          <figure id="fig15"><img alt="Sending 'Get Version' Command to ESP8266 Module"
                                              src="../sites/default/files/wot_tutorials/networking/esp8266-AT%2bGMR-before.png" />
                                            <figcaption>Figure 15: Sending 'Get Version' Command to ESP8266 Module.
                                            </figcaption>
                                          </figure>

                                          <p><strong>Note:</strong> the "Display" tab of the Realterm UI provides useful
                                            settings for selecting how the data is displayed. Normally, you'll want to
                                            select "Ascii" or "Ansi" as the value of the "Display As" parameter. In
                                            addition to normal characters, from the ASCII table, the "Ascii" mode shows
                                            also the special chars, such as CR and LF, which are important when using
                                            Realterm to debug or control ESP8266 module.</p>

                                          <h2>Use Arduino and HTTP(S) to Access Online Services via an WiFi Network</h2>

                                          <p>In this section we are going to use Arduino UNO, ESP02 WiFi module
                                            (remember, we chose to use this specific one out of all existing variations)
                                            and the DHT22 temperature and humidity sensor. With the ESP02 module we are
                                            going to connect to a WiFi network, thus gaining access to internet. Using a
                                            free <a href="http://thingspeak.com/">thingspeak.com</a> account, we store
                                            the temperature and humidity values, with the purpose of having charts that
                                            shows the evolution over time. We send a sample every 15 seconds, since it
                                            is highly improbable to have changes of temperature and humidity values
                                            faster than this, which also provides a lower power consumption, since the
                                            ESP8266 modules are quite power efficient in "stand-by" mode, but this
                                            changes a lot when data is transmitted over WiFi.</p>

                                          <p>It may be useful to have also a USB-TTL module near you, so in case of the
                                            case that your ESP8266 module seems irresponsible, you can try to provide
                                            commands directly via Realterm software, as discussed earlier in this
                                            tutorial.</p>

                                          <h3>Hardware Configuration</h3>

                                          <p>As shown in <a href="#fig16">Figure 16</a> and <a href="#fig17">Figure
                                              17</a>, for this project we need the following components:</p>

                                          <ul>
                                            <li>An Arduino UNO board, but you can use almost any Arduino board, with
                                              minimal or no modifications.</li>
                                            <li>An ESP02 WiFi module, but you can also use any of the 12 available
                                              versions, just remember to update the firmware.</li>
                                            <li>A DHT22 temperature and humidity sensor, but if you like, DHT11/21 or
                                              LM35 are as good, you'll just need to adapt your code related to sensor
                                              reading.</li>
                                            <li>A voltage LC module, that allows the communication between Arduino and
                                              ESP02 module, but you can skip this in case you are using a 3.3V Arduino
                                              board (e.g., Arduino DUE).</li>
                                            <li>A voltage regulator module, that uses USB or a power brick to provide
                                              the 3.3V@500mA required by the ESP02, and most of the other ESP modules.
                                            </li>
                                            <li>Three 10k resistors, used to PULL UP the DHT22 data pin and the RST and
                                              CH_PD pins of the ESP02 module.</li>
                                          </ul>

                                          <p>In addition, an USB-TTL module may be useful for debugging, but this is not
                                            required for the functionality of the circuit. Notice that the connection
                                            between GPIO0 pin of the ESP8266 module and GND is dropped, that being only
                                            required for the firmware update. If you still have that connection, now is
                                            the case to disable it, because your module needs to boot up, and that is
                                            not the case as long as GPIO0 is connected to GND. You should let GPIO0 pin
                                            floating (not connected).</p>

                                          <figure id="fig16"><img
                                              alt="ESP8266 WiFi Module Connected to an Arduino UNO Board"
                                              src="../sites/default/files/wot_tutorials/networking/arduino-esp8266-breadboard.png" />
                                            <figcaption>Figure 16: ESP8266 WiFi Module Connected to an Arduino UNO
                                              Board.</figcaption>
                                          </figure>

                                          <figure id="fig17"><img
                                              alt="Circuit Diagram of an ESP8266 WiFi Module Connected to an Arduino UNO Board"
                                              src="../sites/default/files/wot_tutorials/networking/arduino-esp8266-schematics.png" />
                                            <figcaption>Figure 17: Circuit Diagram of an ESP8266 WiFi Module Connected
                                              to an Arduino UNO Board.</figcaption>
                                          </figure>

                                          <h3>SoftwareConfiguration</h3>

                                          <p>In this section we'll learn how to use the AT commands set for being able
                                            to connect to a WiFi network, then using TCP connect to a live server, and
                                            last, send the temperature and humidity values to <a
                                              href="http://thingspeak.com/">thingspeak.com</a> for being stored and
                                            having displayed them as a chart.</p>

                                          <p><strong>Note:</strong> all the source code, including the required
                                            libraries are included in the zip archive available for download as part of
                                            this article (check the article head), but we encourage you to visit our <a
                                              href="https://github.com/dimircea/Arduino">github.com project page</a>
                                            where you can download the latest changes, updates and fixes for this code
                                            and much more.</p>

                                          <p>First, you'll need to setup a free account at <a
                                              href="https://thingspeak.com/">thingspeak.com</a>. Then, in the "Channel
                                            Settings" menu enable "Field 1" and "Field 2", and give them some human
                                            readable names, such as "DHT-Temperature" and "DHT-Humidity". Then, navigate
                                            to "Api Keys" menu and copy the "Write API Key" value and paste it on the
                                            ESP8266_DHT22.ino as the value of <code>DATA_SERVER_API_KEY</code> constant.
                                            The file ESP8266_DHT22.ino is located under under
                                            examples/ESP8266/ESP8266_DHT22 folder. Remember to replace also
                                            <code>WIFI_SSID</code> and <code>WIFI_PASSWORD</code> constants values with
                                            your own WiFi network credentials.
                                          </p>

                                          <p>Second, you'll need to copy the DHTxx and ESP8266 folders, located under
                                            libraries sub-folder, into your libraries sub-folder of the Arduino IDE
                                            software. This is required because we'll use these two libraries with our
                                            example code.</p>

                                          <p>Lets have now a look at the example code, part of the
                                            <em>examples/ESP8266/ESP8266_DHT22/ESP8266_DHT22.ino</em> Arduino sketch.
                                            Like with any Arduino porgram, we'll need to include the library headers, in
                                            our case these are DHTxx.h and ESP8266.h. We also define a constant for the
                                            I/O pin used to communicate with the DHT22 sensor, and a set of constants
                                            that stores the WiFi credentials (SSID and password), thingspeak.com server
                                            address (api.thingspeak.com), the TCP port used for connection, the request
                                            path and the thingspeak.com "Write API Key" (required for being able to
                                            write data).
                                          </p>

                                          <pre>
#include &lt;dhtxx.h&gt;
#include &lt;esp8266.h&gt;
#define DHT_PIN 7

// WiFi authentication data
const char* WIFI_SSID = "your-wifi-ssid";
const char* WIFI_PASSWORD = "your-wifi-password";

// data server address and port
const char* DATA_SERVER_ADDRESS = "api.thingspeak.com"
const uint8_t DATA_SERVER_PORT = 80;

// data to be sent to the server
const char* DATA_SERVER_API_KEY = "your-thingspeak-write-api-key";
char* DATA_SERVER_PATH = "/update";
</pre>

                                          <p>Further, we have to create the Dht and ESP8266 objects, responsible for the
                                            communication with the DHT22 sensor and ESP8266 WiFi module.</p>

                                          <pre>
Dht dht(DHT_PIN, Dht::TypeEL::DHT22);
ESP8266 esp(Serial);
</pre>

                                          <p>The Arduino board and the ESP8266 module communicates via the serial port,
                                            thus we use the <code>Serial</code> object as the middle-ware. The
                                            <code>Serial</code> global object, which is Arduino specific, is provided as
                                            parameter to the ESP8266 object and used internally to read and write data,
                                            as well as to deal with the incoming data streams and extract the relevant
                                            information.
                                          </p>

                                          <p>The <code>setup</code> method takes care of the Serial port initialization
                                            (communication is made at 115200bps). In addition, it creates a loop while
                                            trying to connect the ESP8266 module to the specified WiFi network
                                            (credentials are provided by the <code>WIFI_SSID</code> and
                                            <code>WIFI_PASSWORD</code> constants).
                                          </p>

                                          <pre>
void setup() {  
  Serial.begin(115200);
  esp.atCwmode(ESP8266::WiFiMode::STA);
  while (esp.atCwjap(WIFI_SSID, WIFI_PASSWORD) != ESP8266::Error::NONE);
};
</pre>

                                          <p>The <code>atCwjap</code> method, part of the <code>ESP8266</code> library,
                                            is responsible with the WiFi connection for the specified WiFi network. This
                                            method is the equivalent of
                                            <code>AT+CWJAP="wifi-ssid","wifi-password"</code> command, which we can send
                                            to the ESP8266 module, e.g., by using Realterm. The library we are using,
                                            contains a set of methods, most of them being a one-to-one mapping of a
                                            specific AT command, and the method name is the AT command name (e.g.,
                                            <code>AT+CWJAP</code> has the equivalent method <code>atCwjap</code>).
                                            However, notice that this library does not covers the complete set of
                                            available AT commands.
                                          </p>

                                          <p>It is important to know that the ESP8266 module may work in three different
                                            modes: client (STA), access point (AP) and both combined (AP+STA). The
                                            <code>AT+CWMODE</code> command allows to set one of these modes, and the
                                            used values are: 1 for <code>STA</code>, 2 for <code>AP</code> and 3 for
                                            <code>AP+STA</code>. E.g., <code>AT+CWMODE=1</code> sets the module in
                                            client (station) mode. Our ESP8266 library has an equivalent method,
                                            <code>atCwmode</code> for this command. It takes as parameter an enumeration
                                            literal value, <code>ESP8266::WiFiMode::xxx</code>, where
                                            <code>xxx = {STA, AP, AP_STA}</code>. Since we use the WiFi module to
                                            connect to a network, she STA mode is the most appropriate, and we set this
                                            in the <code>setup</code> method. It will also work if AP+STA mode is used,
                                            but this have some security implications, because the WiFi module becomes
                                            also an WiFi access point that has internet access, and unless you know
                                            exactly what you are doing, it may open serious security back-doors in your
                                            network.
                                          </p>

                                          <p>In the <code>loop</code> method (remember, this method executes again, and
                                            again as long as the Arduino receives power) we check if we have a WiFi
                                            connection, and if that is true, we perform a DHT22 sensor reading and sent
                                            it to thingspeak.com by using the <code>sendDataToServer</code> method, that
                                            we'll discuss further. We do this with a periodicity of 15 seconds, thus the
                                            <code>delay(15000)</code> call. Notice that the real time between sending
                                            data is larger, since various other delays occurs in the code, such as for
                                            the TCP connection, data sending, and so on.
                                          </p>

                                          <pre>
void loop() {
  if (!checkWiFi()) return;
  Dht::Result result = dht.read();
  if (result.status == Dht::StatusEL::OK) 
    sendDataToServer(result.temperature, result.humidity);
  delay(5000);
};
</pre>

                                          <p>The <code>checkWifi</code> method simply sends an <code>AT</code> command
                                            and waits for an <code>OK</code>, which the ESP8266 module normally sends as
                                            response. This command is not really supposed to do something, but just to
                                            have a simple way to detect if a serial communication with the module exists
                                            or not.</p>

                                          <pre>
boolean checkWiFi() {
  if( esp.at() == ESP8266::Error::NONE) return true; 
  return false;
};
</pre>

                                          <p>The <code>sendDataToServer</code> method is responsible with four
                                            operations:</p>

                                          <ul>
                                            <li>creates the HTTP request, by using a template, discussed later in this
                                              tutorial;</li>
                                            <li>opens a TCP connection on port 80, with the specified server (see the
                                              <code>DATA_SERVER_ADDRESS</code> constant);
                                            </li>
                                            <li>sends a GET request to the data server;</li>
                                            <li>finally, closes the TCP connection.</li>
                                          </ul>

                                          <pre>
void sendDataToServer(float temperature, float humidity) {
  char data[64] = {0};
  char *pData = data;
  createDataFromTemplate(pData, temperature, humidity);
  esp.atCipstartTcp(DATA_SERVER_ADDRESS, 80);
  esp.atCipsendHttpGet(DATA_SERVER_PATH, data);
  esp.atCipclose();
};
</pre>

                                          <p>An example of a HTTP GET request that we like to submit looks as follows:
                                          </p>

                                          <pre>
GET /update?api_key=22.7&amp;field1=%s&amp;field2=35.5 HTTP/1.0
</pre>

                                          <p>We see that some static parts are used (the HTTP method name, the request
                                            path <code>/update</code> and the HTTP version specification), but also some
                                            parts that are changing, such as the values of <code>field1</code> and
                                            <code>field2</code> parameters, corresponding to temperature and humidity
                                            values. We'll turn the parameter part of the request into a template, where
                                            the dynamic values are replaced at the request time with specific
                                            temperature and humidity quantities. For this, we define a template char
                                            pointer (you can thing on it like being a string).
                                          </p>

                                          <pre>
const char DATA_TEMPLATE[] PROGMEM = "?api_key=%s&amp;field1=%s&amp;field2=%s";
</pre>

                                          <p>Some magic happens here, because of the keyword PROGMEM. That is not really
                                            related to the template, but to the way on which the "template string" is
                                            stored by the Arduino MCU. Normally, all strings are stored in the RAM, thus
                                            keeping the RAM occupied with data that is only rarely used. The PROGMEM
                                            variable modifier informs the compiler that we like to store this value in
                                            FLASH (remember, we have FLASH sizes with an order of magnitude greater than
                                            RAM!). The problem is now, that we can't just simply read the variable and
                                            expect to have the value there, because what it really stores is the start
                                            address of the FLASH memory where the data was stored. For this reason, we
                                            created the <code>getPMData</code> (get program memory data) method to
                                            extract the real data from FLASH. Notice that this method comes with the
                                            ESP8266 library and is used intensively to deal with the static strings
                                            involved by the communication with the ESP8266 module. This method takes
                                            three parameters: 1) the defined PROGMEM variable; 2) a char pointer with
                                            sufficient allocated memory to store the data you need to read; and 3) a
                                            reference to an <code>uint8_t</code> variable that will be set to a value
                                            representing the length of the data that was read from FLASH.</p>

                                          <p>In the <code>createDataFromTemplate</code> method, we take care to replace
                                            the parameters, represented by <code>%s</code> (denoting a string
                                            parameter), into real values.</p>

                                          <pre>
void createDataFromTemplate( char *&amp;data, float temperature, float humidity) {
  char buffTemp[6] = {0}, buffHum[5] = {0}, tmpl[32] = {0};
  char *pTmpl = tmpl;
  uint8_t templateLen = -1;
  // read template from PROGMEM
  getPMData( DATA_TEMPLATE, pTmpl, templateLen);
  // create data string from template by replacing
  // parameters with their actual values from sensors
  sprintf( data, pTmpl, DATA_SERVER_API_KEY,
    dtostrf( temperature, 0, 1, buffTemp),
    dtostrf( humidity, 0, 1, buffHum));
};
</pre>

                                          <p>Using the <code>getPMData</code> method we read the template from FLASH.
                                            Further, using <code>sprintf</code> we replace the specified parameters
                                            (i.e., which starts with the % symbol) with concrete values. The
                                            <code>dtostrf</code> method allows to transform the float values that we
                                            have for temperature and humidity into strings, used then to fill the
                                            template variables. Notice, that <code>sprintf</code> is able to deal
                                            directly with numeric variables, but unfortunately its version available for
                                            the Arduino sketches lacks this functionality, thus we also need to use
                                            <code>dtostrf</code>.
                                          </p>

                                          <p>Replace the constant values (i.e., WIFI_SSID, WIFI_PASSWORD,
                                            DATA_SERVER_API_KEY and so on) with your own values, then write the sketch
                                            into your Arduino. If all went fine, you should now check your account and
                                            access the "Private View" tab of your thingspeak.com account. In our case,
                                            for a small set of values, we obtain the charts shown in <a
                                              href="#fig18">Figure 18</a>. Remember, that we only set data once every 15
                                            seconds, meaning that it can take a while until you'll see something on your
                                            thingspeak.com chart.</p>

                                          <figure id="fig18"><img
                                              alt="Temperature and Humidity Value Charts at thingspeak.com"
                                              src="../sites/default/files/wot_tutorials/networking/thingspeak-charts.png" />
                                            <figcaption>Figure 18: Temperature and Humidity Value Charts at
                                              thingspeak.com.</figcaption>
                                          </figure>

                                          <h2>Some Points of Attention</h2>

                                          <p>It is important to use a good quality power supply, both for your Arduino
                                            board (if not powered via USB) and the ESP8266 module. A low quality power
                                            supply may have unknown effects, and may produce behaviors like unwanted
                                            resets of the devices. If your ESP8266 module seems to be unstable, i.e.,
                                            often resets by itself, then it is very likely that you have an issue with
                                            the 3.3V rail provided to the module. You can try to add a 1000ÂµF
                                            electrolytic capacitor in parallel with an 0.1ÂµF ceramic capacitor to the
                                            3.3V rail. If this does not improve the module behavior, then try to replace
                                            your power supply. If an oscilloscope is available, you can observe the
                                            behavior of the 3.3V rail.</p>

                                          <p>When using the ESP8266 module with a device that runs the UART
                                            communication on 5V rail (e.g., Arduino UNO and most of the other Arduino
                                            boards), then you <strong> need</strong> to use a voltage LC (level
                                            converter) between the RX and TX lines of the ESP8266 modules and the TX and
                                            RX lines of the paired device. Also, remember, the RX and TX lines are
                                            twisted between the two devices implied in the UART communication.</p>

                                          <p>While the ESP8266 is a really nice and cheap module, the current version is
                                            not rock solid in terms of stability, thus you may observe strange behaviors
                                            sometimes. It may help to reset the software configuration to its default
                                            state, by using the "AT+RESTORE" command. After that, you should configure
                                            the module again, with respect to all parameters you've been set before the
                                            reset (e.g., WiFi connection, client or AP mode, etc). If your module still
                                            misbehaves, then a better power supply may help. Also, be sure that you
                                            didn't wrote a firmware with a version over 1.1.0 on a module that only has
                                            4Mbit (or less) flash size, because you may completely brick your module.
                                          </p>

                                          <p>Sometimes, TCP or UDP connections made via this module are not stable or
                                            you may even get connection refused errors. In this case, you should try a
                                            few more times to be sure that it is really a problem, since in multiple
                                            cases this is just a temporarily problem and can be solved by retrying,
                                            resetting or power cycling the module.</p>

                                          <p>Periodically check the temperature of your ESP8266 module, simply by
                                            putting your finger on the CPU IC. If it feels hot when touched, then
                                            something may be wrong. Usually a hot CPU on the ESP8266 module means that
                                            the module receives more than the 3.3V required on the power line or on the
                                            RX and/or TX lines. Check the voltage, and make sure that this is not the
                                            case. If this is not the case, the high temperature may be due to high WiFi
                                            activity. While this is not unusual for these modules, make sure that the
                                            module is on a place with environment temperature under 30Â°C to avoid
                                            overheating and damaging the CPU.</p>

                                          <p>When using the module in AP (access point) or STA+AP (station and access
                                            point) modes (that is, AT+CWMODE=2 or AT+CWMODE=3), make sure that you set a
                                            good password, otherwise you may have "spy eyes" on your network and may
                                            even result in security breach of your entire enterprise network! To check
                                            if you are in either AP or STA+AP mode, run the "AT+CWMODE?" command and
                                            check which value it returns (+CWMODE:1 means STA mode, +CWMODE:2 means AP
                                            mode and +CWMODE:3 means STA+AP mode).</p>

                                          <h2>Next Tutorial: Part 4 - Control the Environment by Using Actuators</h2>

                                          <p>In this tutorial we'll learn how to use Arduino to produce environment
                                            changes. Specifically, we'll use relays to turn ON/OF lights, miniature
                                            water pumps to ensure the correct soil moisture for our beloved room plants
                                            and a DIY PWM actuator to adjust the intensity of a dimmable LED strip, used
                                            to produce ambient light on a room.</p>

                                          <p>The release date of the 4th part is: before 24 May 2016.</p>
                                        </div>
                                      </div>
                                    </div>
                                    <section
                                      class="field field-name-field-category field-type-taxonomy-term-reference field-label-above view-mode-full">
                                      <h2 class="field-label">Category:&nbsp;</h2>
                                      <ul class="field-items">
                                        <li class="field-item even"><a href="../taxonomy/term/40.html"
                                            typeof="skos:Concept" property="rdfs:label skos:prefLabel"
                                            datatype="">WoT</a></li>
                                        <li class="field-item odd"><a href="../taxonomy/term/45.html"
                                            typeof="skos:Concept" property="rdfs:label skos:prefLabel"
                                            datatype="">Sensor</a></li>
                                        <li class="field-item even"><a href="../../Arduino/index.html" typeof="skos:Concept"
                                            property="rdfs:label skos:prefLabel" datatype="">Arduino</a></li>
                                      </ul>
                                    </section>
                                    <div class="easy_social_box clearfix horizontal easy_social_lang_und">
                                      <div class="easy_social-widget easy_social-widget-twitter first"><a
                                          href="https://twitter.com/share" class="twitter-share-button"
                                          data-url="https://web-engineering.info/node/62" data-count="horizontal"
                                          data-lang="en" data-via="" data-related=":Check it out!"
                                          data-text="WoT with Arduino for Beginners: Part 3 - Connecting to the Internet via WiFi">Tweet</a>
                                      </div>
                                      <div class="easy_social-widget easy_social-widget-facebook">
                                        <fb:like href="62.html" send="true" layout="button_count" width="88"
                                          show_faces="true" action="https://web-engineering.info/node/like"
                                          colorscheme="light" font=""></fb:like>
                                      </div>
                                      <div class="easy_social-widget easy_social-widget-googleplus">
                                        <div class="g-plusone" data-size="medium" data-annotation="bubble"
                                          data-href="https://web-engineering.info/node/62"></div>
                                      </div>
                                      <div class="easy_social-widget easy_social-widget-linkedin last">
                                        <script type="in/share" data-url="https://web-engineering.info/node/62"
                                          data-counter="right"></script>
                                      </div>
                                    </div> <!-- /.easy_social_box -->
                                    <div id="disqus_thread"><noscript>
                                        <p><a
                                            href="http://web-engineering.disqus.com/?url=https%3A%2F%2Fweb-engineering.info%2Fnode%2F62">View
                                            the discussion thread.</a></p>
                                      </noscript></div>
                                  </div>

                                  <nav class="clearfix">
                                    <ul class="links inline">
                                      <li class="blog_usernames_blog first last"><a href="../blog/24.html"
                                          title="Read mdiaconescu&#039;s latest blog entries.">mdiaconescu&#039;s
                                          blog</a></li>
                                    </ul>
                                  </nav>


                                </div>
                              </article>

                            </div>
                          </div>
                        </div>


                      </div>
                    </div>

                  </section>

                  <div class="region region-content-aside">
                    <div class="region-inner clearfix">
                      <div id="block-block-2"
                        class="block block-block no-title odd first last block-count-3 block-region-content-aside block-2">
                        <div class="block-inner clearfix">

                          <div class="block-content content">
                            <p style="text-align: center; margin-top: 10px;">Â©
                              2014-2020&nbsp;web-engineering.info&nbsp;<a
                                href="https://plus.google.com/104237216582874489152" rel="publisher"><img alt="G+"
                                  src="../../assets/images/gplus-16.png" style="width: 16px; height: 16px;" /></a> | <a
                                href="../../about/index.html">About Us</a> | <a href="../../privacy/index.html">Privacy
                                Policy</a> | Terms
                              &amp;
                              Conditions</p>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <div class="region region-sidebar-first sidebar">
                <div class="region-inner clearfix">
                  <nav id="block-system-main-menu"
                    class="block block-system block-menu odd first block-count-3 block-region-sidebar-first block-main-menu"
                    role="navigation">
                    <div class="block-inner clearfix">
                      <h2 class="block-title">Main menu</h2>

                      <div class="block-content content">
                        <ul class="menu clearfix">
                          <li class="first leaf menu-depth-1 menu-item-1476"><a href="https://sim4edu.com"
                              title="The Simulation for Education (Sim4edu) project website supports web-based simulation with open source technologies for science and education.">Web-Based
                              Discrete Event Simulation</a></li>
                          <li class="leaf menu-depth-1 menu-item-1218"><a href="../../WebAppBook/index.html"
                              title="Web Applications with JavaScript or Java">Textbook
                              Web Apps JS+Java</a></li>
                          <li class="leaf menu-depth-1 menu-item-1477"><a href="../../textbooknode80/index.html">Book
                              Information Management</a></li>
                          <li class="leaf menu-depth-1 menu-item-366"><a href="../../blog/index.html"
                              title="A blog about web engineering issues.">Web Engineering
                              Blog</a></li>
                          <li class="leaf menu-depth-1 menu-item-758"><a
                              href="../../SummariesCheatsheetsPosters/index.html">Summaries
                              &amp; Cheat
                              Sheets</a></li>
                          <li class="leaf menu-depth-1 menu-item-361"><a href="../../JsFrontendApp/index.html"
                              title="This 6-part tutorial shows how to build front-end web applications with plain JavaScript, not using any (third-party) framework or library.">Front-End
                              Apps with Plain JS</a></li>
                          <li class="leaf active-trail menu-depth-1 menu-item-465"><a
                              href="../../JavaJpaJsfApp/index.html"
                              title="Learn how to build back-end Java web applications with Java Server Faces (JSF) as the user interface technology, the Java Persistence API (JPA) as the object-to-storage mapping technology, and a MySQL database."
                              class="active-trail active">Back-End Apps with Java EE</a>
                          </li>
                          <li class="leaf menu-depth-1 menu-item-806"><a href="../../mODELcLASSjsApp/index.html"
                              title="Getting rid of boilerplate code with the model-based development approach of mODELcLASSjs.">Apps
                              with mODELcLASSjs </a></li>
                          <li class="leaf menu-depth-1 menu-item-805"><a href="../../WoTProjects/index.html"
                              title="A WoT system is a communication network consisting of sensor nodes, actuator nodes and service nodes connected to the Internet and built with web technologies.">Web
                              of Things (WoT)</a></li>
                          <li class="leaf menu-depth-1 menu-item-613"><a href="../../forum/index.html"
                              title="">Discussion
                              Forums</a>
                          </li>
                          <li class="leaf menu-depth-1 menu-item-720"><a href="../../team/index.html"
                              title="Team members list.">Team</a></li>
                          <li class="last leaf menu-depth-1 menu-item-554"><a
                              href="../../contribute/index.html">Contribute
                              / Support Us</a>
                          </li>
                        </ul>
                      </div>
                    </div>
                  </nav>
                  
                </div>
              </div>
            </div>
          </div>

        </div>
      </div>




    </div>
  </div>
</body>


</html>